# ä¸ƒå¤§è®¾è®¡åŸåˆ™

## å¼€é—­åŸåˆ™

å¼€é—­åŸåˆ™ï¼ˆOpen-Closed Principleï¼ŒOCPï¼‰æ˜¯æŒ‡ä¸€ä¸ªè½¯ä»¶å®ä½“ï¼ˆå¦‚ç±»ã€æ¨¡å—å’Œå‡½æ•°ï¼‰åº”è¯¥<strong style="color:#ae3520;">å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­</strong>ã€‚å®ƒå¼ºè°ƒçš„æ˜¯<strong style="color:#ae3520;">ç”¨æŠ½è±¡æ„å»ºæ¡†æ¶ï¼Œç”¨å®ç°æ‰©å±•ç»†èŠ‚</strong>ï¼Œè¿™æ ·å¯ä»¥æé«˜è½¯ä»¶ç³»ç»Ÿçš„å¯å¤ç”¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚å¼€é—­åŸåˆ™æ˜¯é¢å‘å¯¹è±¡è®¾è®¡ä¸­æœ€åŸºç¡€çš„è®¾è®¡åŸåˆ™ï¼Œå®ƒæŒ‡å¯¼å’±ä»¬å¦‚ä½•å»ºç«‹ç¨³å®šã€çµæ´»çš„ç³»ç»Ÿã€‚è½¯ä»¶ä¸­<strong style="color:#ae3520;">æ˜“å˜çš„ç»†èŠ‚å¯ä»¥ä»æŠ½è±¡æ´¾ç”Ÿå‡ºæ¥çš„å®ç°ç±»è¿›è¡Œæ‰©å±•</strong>ï¼Œå½“è½¯ä»¶éœ€è¦å‘ç”Ÿå˜åŒ–æ—¶ï¼Œåªéœ€è¦æ ¹æ®éœ€è¦é‡æ–°æ´¾ç”Ÿä¸€ä¸ªå®ç°ç±»æ¥æ‰©å±•å³å¯ã€‚

<strong style="color:#ae3520;">å¼€é—­åŸåˆ™çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯é¢å‘æŠ½è±¡ç¼–ç¨‹</strong>ï¼Œè€Œä¸æ˜¯é¢å‘å…·ä½“å®ç°ç¼–ç¨‹ï¼Œå› ä¸ºæŠ½è±¡ç›¸å¯¹ç¨³å®šã€‚è®©ç±»ä¾èµ–äºå›ºå®šçš„æŠ½è±¡ï¼Œæ‰€ä»¥å¯¹ä¿®æ”¹å°±æ˜¯å°é—­çš„ï¼›åˆ©ç”¨é¢å‘å¯¹è±¡ä¸­çš„ç»§æ‰¿ä¸å¤šæ€æœºåˆ¶ï¼Œå¯ä»¥é’ˆå¯¹æŠ½è±¡åšå…·ä½“å®ç°ï¼Œé€šè¿‡è¦†å†™å…¶æ–¹æ³•æ¥æ”¹å˜å›ºæœ‰è¡Œä¸ºï¼Œå®ç°æ–°çš„æ‰©å±•æ–¹æ³•ï¼Œæ‰€ä»¥å¯¹æ‰©å±•å°±æ˜¯å¼€æ”¾çš„ã€‚

ä¸¾ä¸ªæ —å­ï¼šä»¥æŸå­¦é™¢çš„è¯¾ç¨‹ä½“ç³»ä¸ºä¾‹ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªè¯¾ç¨‹æ¥å£ `ICourse`ï¼š

```java
public interface ICourse {
    Integer getId();

    String getName();
  
    Double getPrice();
}
```

æ•´ä¸ªè¯¾ç¨‹ç”Ÿæ€æœ‰ Java æ¶æ„ã€å¤§æ•°æ®ã€äººå·¥æ™ºèƒ½ã€å‰ç«¯ã€è½¯ä»¶æµ‹è¯•ç­‰ï¼Œå’±ä»¬æ¥åˆ›å»ºä¸€ä¸ª Java æ¶æ„è¯¾ç¨‹çš„ç±» `JavaCourse`ï¼š

```java
public class JavaCourse implements ICourse {
    private final Integer id;
    private final String name;
    private final Double price;

    public JavaCourse(Integer id, String name, Double price) {
        this.id = id;
        this.name = name;
        this.price = price;
    }

    @Override
    public Integer getId() {
        return id;
    }

    @Override
    public String getName() {
        return name;
    }

    @Override
    public Double getPrice() {
        return price;
    }
}
```

ç°åœ¨å’±ä»¬è¦ç»™ Java æ¶æ„è¯¾ç¨‹åšæ´»åŠ¨ï¼Œä»·æ ¼ä¼˜æƒ ã€‚å¯èƒ½æœ‰äº›åˆšå…¥èŒçš„å°ä¼™ä¼´ä¼šåœ¨åŸæœ‰çš„ä»£ç ä¸Šåšæ”¹åŠ¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```java
@Override
public Double getPrice() {
  return price * 0.6;
}
```

è¿™è‚¯å®šæ˜¯ä¸ç¬¦åˆå¼€é—­åŸåˆ™çš„ï¼Œè™½ç„¶è¿™æ ·åšçœ‹èµ·æ¥æœ€ç›´æ¥ï¼Œä¹Ÿæœ€ç®€å•ï¼Œä½†æ˜¯åœ¨ç»å¤§éƒ¨åˆ†é¡¹ç›®ä¸­ï¼Œä¸€ä¸ªåŠŸèƒ½çš„å®ç°è¿œæ¯”æƒ³è±¡çš„è¦å¤æ‚çš„å¤šï¼Œå’±ä»¬åœ¨åŸæœ‰çš„ä»£ç ä¸­è¿›è¡Œä¿®æ”¹ï¼Œå…¶é£é™©è¿œæ¯”æ‰©å±•å’Œå®ç°ä¸€ä¸ªæ–¹æ³•è¦å¤§çš„å¤šï¼Œå› ä¸ºä½ æ°¸è¿œä¸çŸ¥é“ä¿®æ”¹è¿™è¡Œä»£ç ä¼šå¯¹å…¶ä»–åœ°æ–¹çš„è°ƒç”¨ç»“æœé€ æˆä»€ä¹ˆæ ·çš„å½±å“ã€‚

é‚£ä¹ˆå’±ä»¬å¦‚ä½•åœ¨ä¸ä¿®æ”¹åŸæœ‰ä»£ç çš„å‰æä¸‹ï¼Œå®ç°è¿™ä¸ªä»·æ ¼ä¼˜æƒ çš„åŠŸèƒ½å‘¢ï¼Ÿæ­£ç¡®åšæ³•åº”è¯¥æ˜¯å†å†™ä¸€ä¸ªå¤„ç†ä¼˜æƒ é€»è¾‘çš„ç±» `JavaDiscountCourse`ï¼Œè¯¥ç±»ç»§æ‰¿è‡ª `JavaCourse` å¹¶æ–°å¢äº†ä¸€ä¸ªè·å–æŠ˜æ‰£ä»·æ ¼çš„æ–¹æ³• `getDiscountPrice()`ï¼Œè¿™ä¸ªæ–¹æ³•ç›¸å½“äºä¸€ä¸ªæ‰©å±•æ–¹æ³•ã€‚

```java
public class JavaDiscountCourse extends JavaCourse {
    public JavaDiscountCourse(final Integer id, final String name, final Double price) {
        super(id, name, price);
    }

    public Double getDiscountPrice() {
        return super.getPrice() * 0.6;
    }
}
```

ğŸ¤”æ€è€ƒä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆä¸æŠŠå®ƒè®¾è®¡æˆä¸€ä¸ªå…±ç”¨çš„æŠ˜æ‰£ç±»å‘¢ï¼Œæ¯”å¦‚ `DiscountCourse`ï¼Œç„¶åè®©æ‰€æœ‰çš„å®ç°ç±»éƒ½ç»§æ‰¿è‡ªè¿™ä¸ªæŠ˜æ‰£ç±»ï¼Ÿè¿™æ˜¯å› ä¸ºæ¯ç§å®ç°ç±»çš„æŠ˜æ‰£æ–¹æ¡ˆå¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥å’±ä»¬æœ€å¥½èƒ½æŠŠå®ƒä½œä¸ºæ¯ä¸ªå®ç°ç±»çš„å­ç±»å»å•ç‹¬å®ç°ã€‚å¦‚æœä½ èƒ½ç¡®ä¿ä½ çš„ä¸šåŠ¡ä¸­çš„æ–°åŠŸèƒ½èƒ½å…¼å®¹æ‰€æœ‰ç›¸å…³è”çš„éœ€æ±‚ä½ ä¹Ÿå¯ä»¥å…±ç”¨ä¸€ä¸ªã€‚

å›é¡¾ä¸€ä¸‹ï¼Œç®€å•çœ‹ä¸€ä¸‹ç±»ç»“æ„å›¾ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```plantuml
@startuml

interface ICourse << interface >> {
  + getName(): String
  + getPrice(): Double
  + getId(): Integer
}
class JavaCourse implements ICourse {
  - price: Double
  - id: Integer
  - name: String
  + getId(): Integer
  + getName(): String
  + getPrice(): Double
  + JavaCourse(Integer, String, Double): 
}
class JavaDiscountCourse extends JavaCourse {
  + getDiscountPrice(): Double
  + JavaDiscountCourse(Integer, String, Double): 
}
       
@enduml
```

## ä¾èµ–å€’ç½®åŸåˆ™

ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependence Inversion Principleï¼ŒDIPï¼‰æ˜¯æŒ‡è®¾è®¡ä»£ç ç»“æ„æ—¶ï¼Œé«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–åº•å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ã€‚æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ï¼ˆHigh level modules shouldnot depend upon low level modules.Both should depend upon abstractions.Abstractions should not depend upon details. Details should depend upon abstractionsï¼‰ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š<strong style="color:#ae3520;">è¦é¢å‘æ¥å£ç¼–ç¨‹ï¼Œä¸è¦é¢å‘å®ç°ç¼–ç¨‹</strong>ã€‚

é€šè¿‡ä¾èµ–å€’ç½®ï¼Œå¯ä»¥å‡å°‘ç±»ä¸ç±»ä¹‹é—´çš„è€¦åˆæ€§ï¼Œæé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œæé«˜ä»£ç çš„å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ï¼Œå¹¶ä¸”èƒ½é™ä½ä¿®æ”¹ç¨‹åºæ‰€å¼•èµ·çš„é£é™©ã€‚

å¤§å®¶è¦åˆ‡è®°ï¼š<strong style="color:#ae3520;">ä»¥æŠ½è±¡ä¸ºåŸºå‡†</strong>æ¯”ä»¥ç»†èŠ‚ä¸ºåŸºå‡†æ­å»ºèµ·æ¥çš„æ¡†æ¶è¦ç¨³å®šå¾—å¤šï¼Œå› æ­¤åœ¨æ‹¿åˆ°éœ€æ±‚ä¹‹åï¼Œ<strong style="color:#ae3520;">è¦é¢å‘æ¥å£ç¼–ç¨‹ï¼Œå…ˆé¡¶å±‚å†ç»†èŠ‚åœ°è®¾è®¡ä»£ç ç»“æ„</strong>ã€‚

ä¸¾ä¸ªæ —å­ï¼šå‡è®¾ç°åœ¨å’±ä»¬å‡†å¤‡è‡ªå·±ç»„è£…ä¸€å°ç”µè„‘ï¼Œé…ç½®å®šä¸º Intel çš„ CPU å’Œå†…å­˜æ¡ï¼Œå…·ä½“ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š

::: code-group

```java [InterCPU]
public class InterCPU {
    public void calculate() {
        System.out.println("Intel CPU æ­£åœ¨è¿è¡Œä¸­...");
    }
}
```

```java [InterMemory]
public class InterMemory {
    public void store() {
        System.out.println("Intel å†…å­˜æ¡æ­£åœ¨å­˜å‚¨æ•°æ®ä¸­...");
    }
}
```

```java [Computer] {2-3}
public class Computer {
    private final InterCPU interCPU;
    private final InterMemory interMemory;

    public Computer(InterCPU interCPU, InterMemory interMemory) {
        this.interCPU = interCPU;
        this.interMemory = interMemory;
    }

    public void run() {
        interCPU.calculate();
        interMemory.store();
    }
}
```

```java [ComputerTest]
class ComputerTest {
    @Test
    public void test() {
        InterCPU interCPU = new InterCPU();
        InterMemory interMemory = new InterMemory();
        Computer computer = new Computer(interCPU, interMemory);
        computer.run();
    }
}
```

:::

å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ `Computer` ç±»ä¸­ä½¿ç”¨çš„æ˜¯å…·ä½“å®ç°ï¼šIntel çš„ CPU å’Œå†…å­˜æ¡ã€‚çªç„¶å‘ç°ï¼Œå¥½åƒè‡ªå·±çš„é¢„ç®—ä¸è¶³ï¼Œè¿™ä¸ªæ—¶å€™æ€ä¹ˆåŠï¼Ÿåªèƒ½è¾ƒä½é…ç½®å‘—ï¼Œé…ä¸€å¥— AMD çš„ CPU å’Œå†…å­˜æ¡ã€‚ä½†æ˜¯ç°åœ¨å’±ä»¬åœ¨ `Computer` ç”µè„‘ä¸­å·²ç»å°† CPU å’Œå†…å­˜æ¡å®šæ­»äº†ä¸º Intel çš„ CPU å’Œå†…å­˜æ¡ï¼Œè¦æƒ³é™ä½é…ç½®ï¼Œåªèƒ½ä¿®æ”¹åŸå…ˆä»£ç ï¼Œæ— æ³•é€šè¿‡æ‰©å±•çš„æ–¹å¼å®ç°ã€‚æ­¤æ—¶ï¼Œå°±çªå‡ºäº†ä¾èµ–å€’ç½®åŸåˆ™çš„é‡è¦æ€§ï¼Œè¦é¢å‘æ¥å£ç¼–ç¨‹ï¼Œä¸è¦é¢å‘å®ç°ç¼–ç¨‹ï¼Œå’±ä»¬åˆ†åˆ«å®šä¹‰ä¸€ä¸ª `CPU` å’Œ `Memory` çš„æ¥å£ï¼Œè®© `IntelCPU` å’Œ `IntelMemory` åˆ†åˆ«ç»§æ‰¿è‡ªè¿™ä¸¤ä¸ªæ¥å£ï¼Œç„¶ååœ¨ `Computer` ç±»ä¸­ä½¿ç”¨ `CPU` å’Œ `Memory` è¿™ä¸¤ä¸ªæ¥å£ä½œä¸ºå±æ€§ï¼Œä¸å†ä½¿ç”¨å…·ä½“å®ç°ä½œä¸ºå±æ€§ï¼Œè¿™æ ·åšä¹‹åï¼Œå³ä½¿æ¢ä¸€å¥— AMD çš„é…ç½®ä¹Ÿä¸éœ€è¦ä¿®æ”¹ `Computer` ç±»ä¸­åŸæœ‰çš„ä»£ç ï¼Œåªéœ€è¦è®© `AMDCPU` å’Œ `AMDMemory` åˆ†åˆ«å®ç°è¿™ä¸¤ä¸ªæ¥å£ `CPU` å’Œ `Memory` å³å¯ï¼Œåç»­ä½¿ç”¨å…¶ä»–å“ç‰Œçš„é…ç½®åŒæ ·å¦‚æ­¤ï¼Œæ— éœ€æ”¹åŠ¨åŸæœ‰çš„ä»£ç ï¼Œåªéœ€åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±•å³å¯ã€‚è¿™æ ·åšè¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œé‚£å°±æ˜¯æˆ‘å¯ä»¥å°†ä¸åŒå“ç‰Œçš„ CPU å’Œ å†…å­˜æ¡æ··ç€ç”¨ï¼Œç…§æ ·å¯ä»¥æ­£å¸¸å·¥ä½œã€‚å…·ä½“ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š

::: code-group

```java [CPU]
public interface CPU {
    void calculate();
}
```

```java [Memory]
public interface Memory {
    void store();
}
```

```java [IntelCPU]
public class InterCPU implements CPU {
    @Override
    public void calculate() {
        System.out.println("Intel CPU æ­£åœ¨è¿è¡Œä¸­...");
    }
}
```

```java [IntelMemory]
public class InterMemory implements Memory {
    @Override
    public void store() {
        System.out.println("Intel å†…å­˜æ¡æ­£åœ¨å­˜å‚¨æ•°æ®ä¸­...");
    }
}
```

```java [AMDCPU]
public class AMDCPU implements CPU {
    @Override
    public void calculate() {
        System.out.println("AMD CPU æ­£åœ¨è¿è¡Œä¸­...");
    }
}
```

```java [AMDMemory]
public class AMDMemory implements Memory {
    @Override
    public void store() {
        System.out.println("AMD å†…å­˜æ¡æ­£åœ¨å­˜å‚¨æ•°æ®ä¸­...");
    }
}
```

```java [Computer] {2-3}
public class Computer {
    private final CPU cpu;
    private final Memory memory;

    public Computer(final CPU cpu, final Memory memory) {
        this.cpu = cpu;
        this.memory = memory;
    }

    public void run() {
        cpu.calculate();
        memory.store();
    }
}
```

```java [ComputerTest]
class ComputerTest {
    @Test
    public void test() {
        InterCPU interCPU = new InterCPU();
        InterMemory interMemory = new InterMemory();
        Computer computer = new Computer(interCPU, interMemory);
        computer.run();
    }

    @Test
    public void test2() {
        AMDCPU amdCPU = new AMDCPU();
        AMDMemory amdMemory = new AMDMemory();
        Computer computer = new Computer(amdCPU, amdMemory);
        computer.run();
    }
}
```

:::

ç±»ç»“æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š

```plantuml
@startuml

interface CPU << interface >> {
  + calculate(): void
}
class InterCPU implements CPU {
  + calculate(): void
}
class AMDCPU implements CPU {
  + calculate(): void
}
interface Memory << interface >> {
  + store(): void
}
class InterMemory implements Memory {
  + store(): void
}
class AMDMemory implements Memory {
  + store(): void 
}
class Computer {
  - cpu: CPU
  - memory: Memory
  + run(): void
  + Computer(CPU, Memory): 
}
         
Computer --> CPU         
Computer --> Memory

@enduml

```

##  å•ä¸€èŒè´£åŸåˆ™

å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle Responsibility Principleï¼ŒSRPï¼‰æ˜¯æŒ‡<strong style="color:#ae3520;">ç±»çš„èŒè´£è¦å•ä¸€ï¼Œä¸è¦å­˜åœ¨å¤šäºä¸€ä¸ªå¯¼è‡´ç±»å˜æ›´çš„åŸå› </strong>ã€‚é€šä¿—çš„è®²ï¼Œå¦‚æœè¿™ä¸ªç±»åŒ…å«äº†ä¸¤ä¸ªæˆ–å¤šä¸ªä¸šåŠ¡ä¸ç›¸å¹²çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»çš„èŒè´£å°±ä¸å¤Ÿå•ä¸€ï¼Œåº”è¯¥å°†å®ƒ<strong style="color:#ae3520;">æ‹†åˆ†æˆå¤šä¸ªåŠŸèƒ½æ›´åŠ å•ä¸€ã€ç²’åº¦æ›´ç»†çš„ç±»</strong>ã€‚è¿™æ ·çš„è®¾è®¡ï¼Œå¯ä»¥é™ä½ç±»çš„å¤æ‚åº¦ï¼Œæé«˜ç±»çš„å¯è¯»æ€§ï¼Œæé«˜ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§ï¼Œé™ä½å˜æ›´å¼•èµ·çš„é£é™©ã€‚æ€»ä½“æ¥è¯´ï¼Œå°±æ˜¯ä¸€ä¸ªç±»ã€æ¥å£æˆ–æ–¹æ³•åªè´Ÿè´£ä¸€é¡¹èŒè´£ã€‚

å•ä¸€èŒè´£åŸåˆ™æ˜¯å®ç°<strong style="color:#ae3520;">é«˜å†…èšã€ä½è€¦åˆ</strong>çš„æŒ‡å¯¼æ–¹é’ˆï¼Œå®ƒæ˜¯<strong style="color:#ae3520;">æœ€ç®€å•ä½†åˆæ˜¯æœ€éš¾è¿ç”¨</strong>çš„åŸåˆ™ï¼Œéœ€è¦è®¾è®¡äººå‘˜å‘ç°ç±»çš„ä¸åŒèŒè´£å¹¶å°†å…¶åˆ†ç¦»ï¼Œè€Œå‘ç°ç±»çš„å¤šé‡èŒè´£éœ€è¦è®¾è®¡äººå‘˜å…·æœ‰è¾ƒå¼ºçš„åˆ†æè®¾è®¡èƒ½åŠ›å’Œç›¸å…³å®è·µç»éªŒã€‚

ä¸¾ä¸ªæ —å­ï¼šSunny è½¯ä»¶å…¬å¸çš„å¼€å‘äººå‘˜é’ˆå¯¹æŸ CRMï¼ˆCustomer Relationship Managementï¼Œå®¢æˆ·å…³ç³»ç®¡ç†ï¼‰ç³»ç»Ÿä¸­å®¢æˆ·ä¿¡æ¯å›¾å½¢ç»Ÿè®¡æ¨¡å—æå‡ºå¦‚ä¸‹å›¾æ‰€ç¤ºçš„åˆå§‹è®¾è®¡æ–¹æ¡ˆï¼š

```plantuml
@startuml

class CsutomerDataChat {
	+ getConnection(): Connection
	+ findCustomers(): List<Customer>
	+ createChart(): void
	+ displayChart(): void
}

note right of CsutomerDataChat::getConnection
  ç”¨äºè¿æ¥æ•°æ®åº“
end note
note right of CsutomerDataChat::findCustomers
  æŸ¥è¯¢æ‰€æœ‰çš„å®¢æˆ·ä¿¡æ¯
end note
note right of CsutomerDataChat::createChart
  åˆ›å»ºå›¾è¡¨
end note
note right of CsutomerDataChat::displayChart
  æ˜¾ç¤ºå›¾è¡¨
end note

@enduml
```

åœ¨ä¸Šå›¾ä¸­ï¼Œ`CsutomerDataChat` ç±»æ‰¿æ‹…äº†å¤ªå¤šçš„èŒè´£ï¼Œæ—¢åŒ…å«ä¸æ•°æ®åº“ç›¸å…³çš„æ–¹æ³•ï¼ŒåˆåŒ…å«ä¸å›¾æ ‡ç”Ÿæˆå’Œæ˜¾ç¤ºç›¸å…³çš„æ–¹æ³•ã€‚å¦‚æœåœ¨å…¶ä»–ç±»ä¸­ä¹Ÿéœ€è¦è¿æ¥æ•°æ®åº“æˆ–è€…ä½¿ç”¨ `findCustomers()` æ–¹æ³•æŸ¥è¯¢å®¢æˆ·ä¿¡æ¯ï¼Œåˆ™éš¾ä»¥å®ç°ä»£ç çš„é‡ç”¨ã€‚æ— è®ºæ˜¯ä¿®æ”¹æ•°æ®åº“è¿æ¥æ–¹å¼è¿˜æ˜¯ä¿®æ”¹å›¾æ ‡æ˜¾ç¤ºæ–¹å¼éƒ½éœ€è¦ä¿®æ”¹è¯¥ç±»ï¼Œå®ƒå­˜åœ¨ä¸æ­¢ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› ï¼Œè¿èƒŒäº†å•ä¸€èŒè´£åŸåˆ™ã€‚å› æ­¤éœ€è¦å¯¹è¯¥ç±»è¿›è¡Œæ‹†åˆ†ï¼Œä½¿å…¶æ»¡è¶³å•ä¸€èŒè´£åŸåˆ™ï¼Œ`CsutomerDataChat` ç±»å¯æ‹†åˆ†æˆå¦‚ä¸‹ä¸‰ä¸ªç±»ï¼š

1. `DBUtil`ï¼šè´Ÿè´£è¿æ¥æ•°æ®åº“ï¼ŒåŒ…å«æ•°æ®åº“è¿æ¥æ–¹æ³• `getConnection()`ï¼›
2. `CustomerDao`ï¼šè´Ÿè´£æ“ä½œæ•°æ®åº“ä¸­çš„ `Customer` è¡¨ï¼ŒåŒ…å«å¯¹ `Customer` è¡¨çš„å¢åˆ æ”¹æŸ¥æ–¹æ³•ï¼Œå¦‚ `findCustomers()`ï¼›
3. `CsutomerDataChat`ï¼šè´Ÿè´£å›¾è¡¨çš„ç”Ÿæˆå’Œæ˜¾ç¤ºï¼ŒåŒ…å« `createChart()` å’Œ `displayChart()` æ–¹æ³•ã€‚ 

ä½¿ç”¨å•ä¸€èŒè´£é‡æ„åçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

```plantuml
@startuml

class CsutomerDataChat {
	- customerDao: CustomerDao
	+ createChart(): void
	+ displayChart(): void
}

class CustomerDao {
	- dbUtil: DBUtil
	+ findCustomers(): List<Customer>
}

class DBUtil {
	- dbUtil: DBUtil
	+ getConnection(): Connection
}

CsutomerDataChat --> CustomerDao
CustomerDao --> DBUtil

@enduml
```

## æ¥å£éš”ç¦»åŸåˆ™

æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregation Principleï¼ŒISPï¼‰æ˜¯æŒ‡<strong style="color:#ae3520;">ç”¨å¤šä¸ªä¸“é—¨çš„æ¥å£ï¼Œè€Œä¸ä½¿ç”¨å•ä¸€çš„æ€»æ¥å£ï¼Œå®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£</strong>ã€‚è¿™ä¸ªåŸåˆ™æŒ‡å¯¼å’±ä»¬åœ¨è®¾è®¡æ¥å£æ—¶åº”å½“æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š

1. ä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªç±»çš„ä¾èµ–åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¹‹ä¸Šï¼›
2. å»ºç«‹å•ä¸€æ¥å£ï¼Œä¸è¦å»ºç«‹åºå¤§è‡ƒè‚¿çš„æ¥å£ï¼›
3. å°½é‡ç»†åŒ–æ¥å£ï¼Œæ¥å£ä¸­çš„æ–¹æ³•å°½é‡å°‘ï¼ˆä¸æ˜¯è¶Šå°‘è¶Šå¥½ï¼Œä¸€å®šè¦é€‚åº¦ï¼‰ã€‚

æ¥å£éš”ç¦»åŸåˆ™å’Œå•ä¸€èŒè´£åŸåˆ™éƒ½æ˜¯ä¸ºäº†æé«˜ç±»çš„å†…èšæ€§ï¼Œé™ä½å®ƒä»¬ä¹‹é—´çš„è€¦åˆæ€§ï¼Œä½“ç°äº†å°è£…çš„æ€æƒ³ï¼Œä½†ä¸¤è€…æ˜¯ä¸åŒçš„ï¼š

- å•ä¸€èŒè´£åŸåˆ™æ³¨é‡çš„æ˜¯èŒè´£ï¼Œè€Œæ¥å£éš”ç¦»åŸåˆ™æ³¨é‡çš„æ˜¯å¯¹æ¥å£ä¾èµ–çš„éš”ç¦»ï¼›
- å•ä¸€èŒè´£åŸåˆ™ä¸»è¦æ˜¯çº¦æŸç±»ï¼Œå®ƒé’ˆå¯¹çš„æ˜¯ç¨‹åºä¸­çš„å®ç°å’Œç»†èŠ‚ï¼›è€Œæ¥å£éš”ç¦»åŸåˆ™ä¸»è¦çº¦æŸæ¥å£ï¼Œä¸»è¦é’ˆå¯¹æŠ½è±¡å’Œç¨‹åºæ•´ä½“æ¡†æ¶çš„æ„å»ºã€‚

æ¥å£éš”ç¦»åŸåˆ™ç¬¦åˆå’±ä»¬å¸¸è¯´çš„é«˜ç±»èšã€ä½è€¦åˆçš„è®¾è®¡æ€æƒ³ï¼Œå¯ä»¥ä½¿ç±»å…·æœ‰å¾ˆå¥½çš„å¯è¯»æ€§ã€å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚å’±ä»¬åœ¨è®¾è®¡æ¥å£çš„æ—¶å€™ï¼Œè¦å¤šèŠ±æ—¶é—´å»æ€è€ƒï¼Œè¦è€ƒè™‘ä¸šåŠ¡æ¨¡å‹ï¼ŒåŒ…æ‹¬å¯¹ä»¥åæœ‰å¯èƒ½å‘ç”Ÿå˜æ›´çš„åœ°æ–¹è¿˜è¦åšä¸€äº›é¢„åˆ¤ã€‚æ‰€ä»¥ï¼Œå¯¹äºæŠ½è±¡ã€å¯¹äºä¸šåŠ¡æ¨¡å‹çš„ç†è§£è¿˜æ˜¯éå¸¸é‡è¦çš„ã€‚

ä¸¾ä¸ªæ —å­ï¼šæ¯”å¦‚å’±ä»¬ç¨‹åºä¸­ç”¨åˆ°å…¬æœ‰äº‘å­˜å‚¨æœåŠ¡ï¼Œæ‰€ä»¥è¯´å’±ä»¬å®šä¹‰ä¸€ä¸ªæŠ½è±¡çš„æ¥å£ `CloudService`ï¼Œåœ¨è¯¥æ¥å£ä¸­å®šä¹‰äº†å’±ä»¬æ‰€æœ‰å¯èƒ½ä¼šç”¨åˆ°çš„ä¸€äº›å­˜å‚¨æ“ä½œç›¸å…³çš„æ–¹æ³•ï¼Œç„¶åå’±ä»¬åº•å±‚æœåŠ¡é€šè¿‡ä¸¤ç§èƒ½åŠ›æ”¯æ’‘ï¼Œä¸€ç§æ˜¯é˜¿é‡Œäº‘ `AlibabaCloud`ï¼Œä¸€ç§æ˜¯è…¾è®¯äº‘ `TencentCloud`ã€‚ç°åœ¨æ¥åˆ†åˆ«å®ç° `CloudService` æ¥å£çš„è¿™ä¸¤ä¸ªå®ç°ç±»ï¼Œå¯¹äºè¿™æ ·ä¸€ä¸ªå¤æ‚ç»“æ„æ¥è¯´ï¼Œå®ƒçš„å®ç°ç±»è¦å®ç°è¯¥æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•ï¼Œä½†å¹¶ä¸ä»£è¡¨å®ƒçš„æ‰€æœ‰å­ç±»éƒ½èƒ½å¤Ÿå»å®ç°è¿™äº›æ–¹æ³•ï¼Œæ¯”å¦‚è¯´ä¸Šé¢è…¾è®¯äº‘çš„ SDK åªæä¾›äº†å­˜å‚¨æ–‡ä»¶å’Œä¸‹è½½æ–‡ä»¶çš„èƒ½åŠ›ï¼Œé‚£å¯¹äºå…¶ä»–æ–¹æ³•å‘¢å®ƒå°±æ²¡æœ‰åŠæ³•å»å®ç°ï¼Œæ‰€ä»¥å¯¹äºå’±ä»¬çš„ä»£ç æ¥è¯´è¿™ä¸ªå­å®ç°ç±» `TencentCloud` å°±ä¼šæœ‰å¾ˆå¤šçš„ç©ºæ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒåªæœ‰å…¶åè€Œæ²¡æœ‰å®é™…æ„ä¹‰ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```plantuml
@startuml

interface CloudService <<interface>> {
  + void storeFile();
  + void downloadFile();
  + void createBucket();
  + void deleteBucket();
  + String getCDNAddress();
}

class TencentCloud implements CloudService {
	+ void storeFile();
  + void downloadFile();
}

class AlibabaCloud implements CloudService {
	+ void storeFile();
  + void downloadFile();
  + void createBucket();
  + void deleteBucket();
  + String getCDNAddress();
}

note right of TencentCloud
  ä¸æ˜¯æ‰€æœ‰å®¢æˆ·ç«¯éƒ½èƒ½æ»¡è¶³å¤æ‚æ¥å£è¦æ±‚
end note

@enduml
```

æ‰€ä»¥è¯´æ›´å¥½çš„æ–¹å¼æ˜¯æŠŠè¿™ä¸ª `CloudService` æ¥å£è¿›è¡Œæ‹†åˆ†ï¼ŒæŠŠå®ƒåˆ†æˆå¤šä¸ªéƒ¨åˆ†ï¼Œç„¶åæ¯ä¸ªå®¢æˆ·ç«¯æ ¹æ®è‡ªå·±çš„å®é™…æƒ…å†µå»å®ç°ä¸åŒçš„æ¥å£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ<strong style="color:#ae3520;">ä¸€ä¸ªå¤æ‚çš„æ¥å£è¢«æ‹†åˆ†æˆä¸€ç»„é¢—ç²’æ›´å°çš„æ¥å£</strong>ï¼Œä½†æ˜¯<strong style="color:#ae3520;">åƒä¸‡è®°ä½ä¸è¦å†è¿›ä¸€æ­¥åˆ’åˆ†å·²ç»éå¸¸å…·ä½“çš„æ¥å£ï¼Œå› ä¸ºåˆ›å»ºçš„æ¥å£è¶Šå¤šä»£ç å°±ä¼šè¶Šå¤æ‚ï¼Œæ‰€ä»¥è¯´å’±ä»¬è¦åœ¨è¿™ä¸ªä¸­é—´å¯»æ±‚å¹³è¡¡</strong>ã€‚

```plantuml
@startuml

interface CloudHostingService <<interface>> {
  + String getCDNAddress();
}

interface CloudBucketService <<interface>> {
  + void createBucket();
  + void deleteBucket();
}

interface CloudStorageService <<interface>> {
  + void storeFile();
  + void downloadFile();
}

class TencentCloud implements CloudStorageService {
	+ void storeFile();
  + void downloadFile();
}

class AlibabaCloud implements CloudHostingService,CloudBucketService,CloudStorageService {
	+ void storeFile();
  + void downloadFile();
  + void createBucket();
  + void deleteBucket();
  + String getCDNAddress();
}

@enduml
```

## è¿ªç±³ç‰¹æ³•åˆ™

è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆLaw Of Demeterï¼ŒLODï¼‰åˆå«æœ€å°‘çŸ¥é“åŸåˆ™ï¼ˆLeast Knowledge Principleï¼ŒLKPï¼‰ï¼Œæ˜¯æŒ‡<strong style="color:#ae3520;">ä¸€ä¸ªç±»å¯¹äºå…¶ä»–ç±»çŸ¥é“çš„è¶Šå°‘è¶Šå¥½</strong> & <strong style="color:#ae3520;">åªä¸ä½ çš„ç›´æ¥æœ‹å‹äº¤æµï¼Œä¸è·Ÿâ€œé™Œç”Ÿäººâ€è¯´è¯</strong>ï¼ˆTalk only to your immediate friends and not to strangersï¼‰ã€‚å…¶å«ä¹‰æ˜¯ï¼š<strong style="color:#ae3520;">å¦‚æœä¸¤ä¸ªè½¯ä»¶å®ä½“æ— éœ€ç›´æ¥é€šä¿¡ï¼Œé‚£ä¹ˆå°±ä¸åº”å½“å‘ç”Ÿç›´æ¥çš„ç›¸äº’è°ƒç”¨ï¼Œå¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹è½¬å‘è¯¥è°ƒç”¨</strong>ã€‚å…¶ç›®çš„æ˜¯é™ä½ç±»ä¹‹é—´çš„è€¦åˆåº¦ï¼Œæé«˜æ¨¡å—çš„ç›¸å¯¹ç‹¬ç«‹æ€§ã€‚

è¿ªç±³ç‰¹æ³•åˆ™ä¸­çš„â€œæœ‹å‹â€æ˜¯æŒ‡ï¼š

- æœ‹å‹ï¼šæœ‰è€¦åˆå…³ç³»ï¼ˆåŒå½“å‰å¯¹è±¡å­˜åœ¨<strong style="color:#ae3520;">ä¾èµ–ã€å…³è”ã€èšåˆæˆ–ç»„åˆ</strong>å…³ç³»ï¼‰çš„å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥è®¿é—®è¿™äº›å¯¹è±¡çš„æ–¹æ³•ã€‚
- <strong style="color:#ae3520;">ç›´æ¥çš„æœ‹å‹ï¼šå‡ºç°åœ¨æˆå‘˜å˜é‡ã€æ–¹æ³•è¾“å…¥ã€è¾“å‡ºå‚æ•°ä¸­çš„ç±»</strong>ï¼Œè€Œ<strong style="color:#ae3520;">å‡ºç°åœ¨æ–¹æ³•ä½“å†…éƒ¨ä¸­çš„ç±»å°±ä¸å±äºæœ‹å‹ç±»</strong>ã€‚

ä¸¾ä¸ªæ —å­ï¼šæ˜æ˜Ÿç”±äºå…¨èº«å¿ƒæŠ•å…¥è‰ºæœ¯ï¼Œæ‰€ä»¥è®¸å¤šæ—¥å¸¸äº‹åŠ¡ç”±ç»çºªäººè´Ÿè´£å¤„ç†ï¼Œå¦‚ä¸ç²‰ä¸çš„è§é¢ä¼šï¼Œä¸åª’ä½“å…¬å¸çš„ä¸šåŠ¡æ´½è°ˆç­‰ã€‚è¿™é‡Œçš„ç»çºªäººå°±æ˜¯æ˜æ˜Ÿçš„æœ‹å‹ï¼Œè€Œç²‰ä¸å’Œåª’ä½“å…¬å¸å°±æ˜¯é™Œç”Ÿäººï¼Œæ‰€ä»¥é€‚åˆä½¿ç”¨è¿ªç±³ç‰¹æ³•åˆ™ã€‚å…¶ç±»ç»“æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š

```plantuml
@startuml

class Agent {
  - company: Company
  - fans: Fans
  - star: Star
  + setStar(Star): void
  + meeting(): void
  + setFans(Fans): void
  + business(): void
  + setCompany(Company): void
}
class Company {
  - name: String
  + getName(): String
}
class Fans {
  - name: String
  + getName(): String
}
class Star {
  - name: String
  + getName(): String
}

Agent --> Company 
Agent --> Fans    
Agent --> Star    

@enduml
```

å…·ä½“ä»£ç å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼š

::: code-group

```java [Star]
public class Star {
    private final String name;

    public Star(final String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }
}
```

```java [Fans]
public class Fans {
    private final String name;

    public Fans(final String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }
}
```

```java [Company]
public class Company {
    private final String name;

    public Company(final String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }
}
```

```java [Agent]
public class Agent {
    private Star star;
    private Fans fans;
    private Company company;

    public void setStar(final Star star) {
        this.star = star;
    }

    public void setFans(final Fans fans) {
        this.fans = fans;
    }

    public void setCompany(final Company company) {
        this.company = company;
    }

    public void meeting() {
        System.out.println(this.fans.getName() + "ä¸æ˜æ˜Ÿ" + this.star.getName() + "è§é¢äº†ï¼");
    }

    public void business() {
        System.out.println(this.company.getName() + "ä¸æ˜æ˜Ÿ" + this.star.getName() + "æ´½æ·¡ä¸šåŠ¡ï¼");
    }
}
```

```java [AgentTest]
class AgentTest {
    @Test
    public void test() {
        Star star = new Star("åˆ˜äº¦è²");
        Fans fans = new Fans("å°è®©");
        Company company = new Company("ä¸­å›½ä¼ åª’æœ‰é™å…¬å¸");
        Agent agent = new Agent();
        agent.setStar(star);
        agent.setFans(fans);
        agent.setCompany(company);
        agent.meeting();
        agent.business();
    }
}
```

:::

## é‡Œæ°æ›¿æ¢åŸåˆ™

é‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆLiskov Substitution Principleï¼ŒLSPï¼‰æ˜¯æŒ‡ä¸€ä¸ªè½¯ä»¶å®ä½“å¦‚æœé€‚ç”¨äºä¸€ä¸ªçˆ¶ç±»ï¼Œé‚£ä¹ˆä¸€å®šé€‚ç”¨äºå…¶å­ç±»ï¼Œ<strong style="color:#ae3520;">ç¨‹åºä¸­æ‰€æœ‰ä½¿ç”¨çˆ¶ç±»å¯¹è±¡çš„åœ°æ–¹å¿…é¡»èƒ½é€æ˜åœ°ä½¿ç”¨å…¶å­ç±»å¯¹è±¡è¿›è¡Œæ›¿æ¢ï¼Œå¹¶ä¸”ä¿è¯åŸæ¥ç¨‹åºçš„é€»è¾‘è¡Œä¸ºä¸å˜ä»¥åŠæ­£ç¡®æ€§ä¸è¢«ç ´å</strong>ã€‚æ ¹æ®è¿™ä¸ªç†è§£ï¼Œå¼•ç”³å«ä¹‰ä¸ºï¼š<strong style="color:#ae3520;">å­ç±»å¯ä»¥æ‰©å±•çˆ¶ç±»çš„åŠŸèƒ½ï¼Œä½†ä¸èƒ½æ”¹å˜çˆ¶ç±»åŸæœ‰çš„åŠŸèƒ½</strong>ã€‚è¿™å¥è¯åŒ…æ‹¬äº†å››ç‚¹å«ä¹‰ï¼š

1. å­ç±»å¯ä»¥å®ç°çˆ¶ç±»çš„æŠ½è±¡æ–¹æ³•ï¼Œä½†ä¸èƒ½è¦†ç›–çˆ¶ç±»çš„éæŠ½è±¡æ–¹æ³•ï¼›
2. å­ç±»å¯ä»¥å¢åŠ è‡ªå·±ç‰¹æœ‰çš„æ–¹æ³•ï¼›
3. å½“å­ç±»çš„æ–¹æ³•é‡è½½çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œæ–¹æ³•çš„å‰ç½®æ¡ä»¶ï¼ˆå³æ–¹æ³•çš„è¾“å…¥å‚æ•°ï¼‰è¦æ¯”çˆ¶ç±»çš„æ–¹æ³•æ›´å®½æ¾ï¼›
4. å½“å­ç±»çš„æ–¹æ³•å®ç°çˆ¶ç±»çš„æ–¹æ³•ï¼ˆé‡å†™/é‡è½½æˆ–å®ç°æŠ½è±¡æ–¹æ³•ï¼‰æ—¶ï¼Œæ–¹æ³•çš„åç½®æ¡ä»¶è¦ï¼ˆå³æ–¹æ³•çš„è¾“å‡º/è¿”å›å€¼ï¼‰è¦æ¯”çˆ¶ç±»çš„æ–¹æ³•æ›´ä¸¥æ ¼æˆ–ä¸çˆ¶ç±»çš„æ–¹æ³•ä¸€æ ·ã€‚

ä½¿ç”¨é‡Œæ°æ›¿æ¢åŸåˆ™æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š

1. çº¦æŸç»§æ‰¿æ³›æ»¥ï¼Œæ˜¯ä½¿ä»£ç ç¬¦åˆå¼€é—­åŸåˆ™çš„ä¸€ä¸ªé‡è¦ä¿è¯ï¼›
2. åŠ å¼ºç¨‹åºçš„å¥å£®æ€§ï¼ŒåŒæ—¶å˜æ›´æ—¶ä¹Ÿå¯ä»¥åšåˆ°éå¸¸å·çš„å…¼å®¹æ€§ï¼Œæé«˜ç¨‹åºçš„å¯ç»´æŠ¤æ€§å’Œæ‰©å±•æ€§ï¼Œé™ä½éœ€æ±‚å˜æ›´æ—¶å¼•å…¥çš„é£é™©ã€‚

ä¸¾ä¸ªæ —å­ï¼šâ€œæ­£æ–¹å½¢ä¸æ˜¯é•¿æ–¹å½¢â€æ˜¯ä¸€ä¸ªç†è§£é‡Œæ°æ›¿æ¢åŸåˆ™çš„æœ€ç»å…¸çš„ä¾‹å­ã€‚åœ¨æ•°å­¦é¢†åŸŸä¸­ï¼Œæ­£æ–¹å½¢æ¯«æ— ç–‘é—®æ˜¯é•¿æ–¹å½¢ï¼Œå®ƒæ˜¯ä¸€ä¸ªé•¿å®½ç›¸ç­‰çš„é•¿æ–¹å½¢ã€‚æ‰€ä»¥ï¼Œåœ¨å’±ä»¬å¼€å‘çš„ä¸€ä¸ªä¸å‡ ä½•å›¾å½¢ç›¸å…³çš„è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œè®©æ­£æ–¹å½¢ç»§æ‰¿è‡ªé•¿æ–¹å½¢å°±æˆäº†ä¸€ä»¶é¡ºç†æˆç« çš„äº‹æƒ…ã€‚

é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªé•¿æ–¹å½¢ç±» `Rectangle`ï¼š

```java
public class Rectangle {
    private long length;
    private long width;

    public long getLength() {
        return length;
    }

    public void setLength(final long length) {
        this.length = length;
    }

    public long getWidth() {
        return width;
    }

    public void setWidth(final long width) {
        this.width = width;
    }
}
```

ç„¶åï¼Œåˆ›å»ºä¸€ä¸ªæ­£æ–¹å½¢ç±» `Square` ç»§æ‰¿è‡ª `Rectangle` é•¿æ–¹å½¢ç±»ï¼šç”±äºæ­£æ–¹å½¢çš„é•¿å®½å¿…é¡»ç›¸ç­‰ï¼Œæ‰€ä»¥ä¸ç®¡æ˜¯åœ¨ `setWidth()` æ–¹æ³•è¿˜æ˜¯åœ¨ `setLength()` æ–¹æ³•ä¸­éƒ½ä¼šåŒæ—¶å¯¹é•¿å®½èµ‹ä»¥ç›¸åŒçš„å€¼ã€‚

```java
public class Square extends Rectangle {
    @Override
    public void setWidth(final long width) {
        super.setWidth(width);
        super.setLength(width);
    }

    @Override
    public void setLength(final long length) {
        super.setWidth(length);
        super.setLength(length);
    }
}
```

åœ¨æµ‹è¯•ç±»ä¸­åˆ›å»º `resize()` æ–¹æ³•ï¼Œç”¨äºæ¨¡æ‹Ÿé•¿æ–¹å½¢å®½åº¦é€æ­¥å¢é•¿ç›´è‡³å®½åº¦å¤§äºé•¿åº¦æ—¶åœæ­¢çš„æ•ˆæœï¼š

```java
class RectangleTest {
    public void resize(final Rectangle rectangle) {
        while (rectangle.getWidth() <= rectangle.getLength()) {
            rectangle.setWidth(rectangle.getWidth() + 1);
            System.out.println("length:" + rectangle.getLength() + ",width:" + rectangle.getWidth());
        }
    }

    @Test
    public void test() {
        final Rectangle rectangle = new Rectangle();
        rectangle.setLength(10);
        rectangle.setWidth(5);
        resize(rectangle);
    }
}
```

åœ¨ä¸Šè¿°æµ‹è¯•æ–¹æ³•ï¼Œå’±ä»¬æŠŠä¸€ä¸ªæ™®é€šçš„é•¿æ–¹å½¢ä½œä¸ºå‚æ•°ä¼ å…¥ `resize()` æ–¹æ³•ä¸­ï¼Œå°±ä¼šçœ‹åˆ°é•¿æ–¹å½¢å®½åº¦é€æ­¥å¢é•¿ç›´è‡³å®½åº¦å¤§äºé•¿åº¦æ—¶åœæ­¢çš„æ•ˆæœï¼Œè¿è¡Œç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š<br />![image-20240328194012510](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202403281940607.png)

ç°åœ¨ï¼Œæˆ‘ä»¬å†æŠŠä¸€ä¸ªæ­£æ–¹å½¢ä½œä¸ºå‚æ•°ä¼ å…¥ `resize()` æ–¹æ³•ä¸­ï¼Œ

```java
@Test
public void test1() {
  final Square square = new Square();
  square.setLength(10);
  resize(square);
}
```

è¿è¡Œä¸Šè¿°æµ‹è¯•æ–¹æ³•ï¼Œå°±ä¼šçœ‹åˆ°æ­£æ–¹å½¢çš„é•¿åº¦å’Œå®½åº¦éƒ½åœ¨ä¸æ–­åœ°å¢é•¿ï¼Œä»£ç å‡ºç°æ­»å¾ªç¯ç›´è‡³å †æ ˆæº¢å‡ºæ‰ä¼šåœæ­¢ã€‚æ‰€ä»¥ï¼Œæ™®é€šçš„é•¿æ–¹å½¢æ˜¯é€‚åˆè¿™æ®µä»£ç çš„ï¼Œè€Œæ­£æ–¹å½¢å´ä¸é€‚åˆã€‚

æ‰€ä»¥å’±ä»¬å¾—å‡ºå¦‚ä¸‹ç»“è®ºï¼šåœ¨ `resize()` æ–¹æ³•ä¸­ï¼Œ`Rectangle` ç±»å‹çš„å‚æ•°æ˜¯ä¸èƒ½è¢« `Square` ç±»å‹çš„å‚æ•°æ‰€æ›¿æ¢ï¼Œå¦‚æœè¿›è¡Œäº†æ›¿æ¢å°±è¾¾ä¸åˆ°é¢„æœŸç»“æœã€‚å› æ­¤ï¼Œ`Square` ç±»å’Œ `Rectangle` ç±»ä¹‹é—´çš„ç»§æ‰¿å…³ç³»è¿åäº†é‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œå®ƒä»¬ä¹‹é—´çš„ç»§æ‰¿å…³ç³»ä¸æˆç«‹ â¡ï¸ æ­£æ–¹å½¢ä¸æ˜¯é•¿æ–¹å½¢ã€‚

## åˆæˆå¤ç”¨åŸåˆ™

åˆæˆå¤ç”¨åŸåˆ™ï¼ˆComposite Reuse Principleï¼ŒCRPï¼‰æ˜¯æŒ‡<strong style="color:#ae3520;">å°½é‡ä½¿ç”¨å¯¹è±¡èšåˆï¼ˆhas-aï¼‰/ç»„åˆï¼ˆcontains-aï¼‰è€Œä¸æ˜¯ç»§æ‰¿ï¼ˆis-aï¼‰å…³ç³»è¾¾åˆ°è½¯ä»¶å¤ç”¨çš„ç›®çš„</strong>ã€‚

> [!tip]
>
> èšåˆå…³ç³»ï¼ˆAggregationï¼‰æ˜¯å…³è”å…³ç³»ä¸­çš„ä¸€ç§ç‰¹ä¾‹ï¼Œå®ƒ**ä½“ç°çš„æ˜¯æ•´ä½“ä¸éƒ¨åˆ†çš„åŒ…å«å…³ç³»ï¼Œå³ â€œ**has a**â€ çš„å…³ç³»ã€‚**èšåˆå…³ç³»å¼ºè°ƒæ˜¯â€œæ•´ä½“â€åŒ…å«â€œéƒ¨åˆ†â€ï¼Œä½†æ˜¯â€œéƒ¨åˆ†â€å¯ä»¥è„±ç¦»â€œæ•´ä½“â€è€Œå•ç‹¬å­˜åœ¨ï¼Œå³æ•´ä½“å’Œéƒ¨åˆ†æ˜¯**å¯ä»¥åˆ†ç¦»**çš„ï¼Œ**æœ‰å„è‡ªçš„ç”Ÿå‘½å‘¨æœŸ**ã€‚åœ¨UMLç±»å›¾ä¸­ï¼Œèšåˆå…³ç³»ç”¨**å¸¦ç©ºå¿ƒè±å½¢å’Œç®­å¤´çš„ç›´çº¿**è¡¨ç¤ºï¼Œ**ç©ºå¿ƒè±å½¢åœ¨æ•´ä½“ä¸€æ–¹**ï¼Œ**ç®­å¤´æŒ‡å‘éƒ¨åˆ†ä¸€æ–¹**ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼šå…¬å¸åŒ…å«é”€å”®ã€å·¥ç¨‹å¸ˆå’Œä¼šè®¡ç­‰äººå‘˜ï¼Œè€Œé”€å”®ã€å·¥ç¨‹å¸ˆå’Œä¼šè®¡è„±ç¦»äº†å…¬å¸ä¹Ÿèƒ½å•ç‹¬å­˜åœ¨ã€‚
>
> ```plantuml
> @startuml
> 
> class Company {
> 	- salesman: Salesman
> 	- engineer: Engineer
> 	- accountant: Accountant
> }
> 
> class Salesman {}
> 
> class Engineer {}
> 
> class Accountant {}
> 
> Company o-- Salesman
> Company o-- Engineer
> Company o-- Accountant
> 
> @enduml
> ```
>
> ç»„åˆå…³ç³»ï¼ˆCompositionï¼‰ä¹Ÿæ˜¯å…³è”å…³ç³»çš„ä¸€ç§ç‰¹ä¾‹ï¼Œå®ƒåŒæ ·**ä½“ç°çš„æ˜¯æ•´ä½“ä¸éƒ¨åˆ†é—´çš„åŒ…å«å…³ç³»**ï¼Œå³ â€œ**contains a**â€ çš„å…³ç³»ã€‚ä½†æ­¤æ—¶**æ•´ä½“ä¸éƒ¨åˆ†æ˜¯ä¸å¯åˆ†çš„**ï¼Œéƒ¨åˆ†ä¹Ÿä¸èƒ½ç»™å…¶å®ƒæ•´ä½“å…±äº«ï¼Œ**æ•´ä½“å¯ä»¥æ§åˆ¶éƒ¨åˆ†çš„ç”Ÿå‘½å‘¨æœŸ**ï¼Œ**æ•´ä½“ä¸€æ—¦ä¸å­˜åœ¨**ï¼Œ**éƒ¨åˆ†ä¹Ÿä¾¿ä¸å­˜åœ¨**ã€‚è¿™ç§å…³ç³»æ¯”èšåˆæ›´å¼ºï¼Œä¹Ÿç§°ä¸º**å¼ºèšåˆ**ã€‚åœ¨UMLç±»å›¾ä¸­ï¼Œç»„åˆå…³ç³»ç”¨**å¸¦å®å¿ƒè±å½¢å’Œç®­å¤´çš„ç›´çº¿**è¡¨ç¤ºï¼Œ**å®å¿ƒè±å½¢åœ¨æ•´ä½“ä¸€æ–¹**ï¼Œ**ç®­å¤´æŒ‡å‘éƒ¨åˆ†ä¸€æ–¹**ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒäººåŒ…å«å¤´ï¼ˆheadï¼‰ã€èº¯å¹²ï¼ˆlimbsï¼‰ã€å››è‚¢ï¼ˆtorsoï¼‰ï¼Œå®ƒä»¬çš„ç”Ÿå‘½å‘¨æœŸä¸€è‡´ã€‚å½“äººå‡ºç”Ÿæ—¶ï¼Œå¤´ã€èº¯å¹²ã€å››è‚¢åŒæ—¶è¯ç”Ÿã€‚å½“äººæ­»äº¡æ—¶ï¼Œä½œä¸ºäººä½“ç»„æˆéƒ¨åˆ†çš„å¤´ã€èº¯å¹²ã€å››è‚¢åˆ™åŒæ—¶æ­»äº¡ã€‚
>
> ```plantuml
> @startuml
> 
> class Person {
>   - head: Head
> 	- limbs: Limbs
> 	- torso: Torso
> }
> 
> class Head {}
> 
> class Limbs {}
> 
> class Torso {}
> 
> Person *--> Head 
> Person *--> Limbs
> Person *--> Torso
> 
> @enduml
> ```

é€šå¸¸ç±»çš„å¤ç”¨åˆ†ä¸º<strong style="color:#ae3520;">ç»§æ‰¿å¤ç”¨</strong>å’Œ<strong style="color:#ae3520;">åˆæˆå¤ç”¨</strong>ä¸¤ç§ã€‚ç»§æ‰¿å¤ç”¨è™½ç„¶æœ‰ç®€å•å’Œæ˜“å®ç°çš„ä¼˜ç‚¹ï¼Œä½†å®ƒå­˜åœ¨ä»¥ä¸‹ç¼ºç‚¹ï¼š

1. ç»§æ‰¿å¤ç”¨ç ´åäº†ç±»çš„å°è£…æ€§ã€‚å› ä¸º<strong style="color:#ae3520;">ç»§æ‰¿ä¼šå°†çˆ¶ç±»çš„å®ç°ç»†èŠ‚æš´éœ²ç»™å­ç±»ï¼Œçˆ¶ç±»å¯¹å­ç±»æ˜¯é€æ˜çš„</strong>ï¼Œæ‰€ä»¥è¿™ç§å¤ç”¨åˆç§°ä¹‹ä¸ºâ€œç™½ç®±â€å¤ç”¨ã€‚
2. å­ç±»ä¸çˆ¶ç±»çš„è€¦åˆåº¦é«˜ã€‚çˆ¶ç±»ä¸­çš„ä»»ä½•æ”¹å˜éƒ½ä¼šå¯¼è‡´å­ç±»å®ç°å‘ç”Ÿå˜åŒ–ï¼Œè¿™ä¸åˆ©äºç±»çš„æ‰©å±•ä¸ç»´æŠ¤ã€‚
3. å®ƒé™åˆ¶äº†å¤ç”¨çš„çµæ´»æ€§ã€‚ä»çˆ¶ç±»ç»§æ‰¿è€Œæ¥çš„å®ç°æ˜¯é™æ€çš„ï¼Œåœ¨ç¼–è¯‘æ—¶å·²ç»å®šä¹‰ï¼Œå› æ­¤åœ¨è¿è¡Œæ—¶ä¸èƒ½å‘ç”Ÿå˜åŒ–ã€‚

é‡‡ç”¨ç»„åˆæˆ–èšåˆå¤ç”¨æ—¶ï¼Œå¯ä»¥å°†å·²æœ‰å¯¹è±¡çº³å…¥æ–°å¯¹è±¡ä¸­ï¼Œä½¿ä¹‹æˆä¸ºæ–°å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œæ–°å¯¹è±¡å¯ä»¥è°ƒç”¨å·²æœ‰å¯¹è±¡çš„åŠŸèƒ½ï¼Œå®ƒæœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š

1. å®ƒç»´æŒäº†ç±»çš„å°è£…æ€§ã€‚å› ä¸ºæˆå‘˜å¯¹è±¡çš„å†…éƒ¨ç»†èŠ‚æ˜¯æ–°å¯¹è±¡çœ‹ä¸è§çš„ï¼Œæ‰€ä»¥è¿™ç§å¤ç”¨åˆç§°ä¹‹ä¸ºâ€œé»‘ç®±â€å¤ç”¨ã€‚
2. ç›¸å¯¹äºç»§æ‰¿å…³ç³»è€Œè¨€ï¼Œè€¦åˆåº¦è¾ƒä½ï¼Œ<strong style="color:#ae3520;">åœ¨ç±»çš„æˆå‘˜ä½ç½®å£°æ˜æŠ½è±¡ï¼ˆæŠ½è±¡ç±»æˆ–è€…æ¥å£ï¼‰</strong>ï¼Œæˆå‘˜å¯¹è±¡çš„å˜åŒ–å¯¹æ–°å¯¹è±¡çš„å½±å“ä¸å¤§ï¼Œå¯ä»¥åœ¨æ–°å¯¹è±¡ä¸­æ ¹æ®å®é™…éœ€è¦æœ‰é€‰æ‹©æ€§åœ°è°ƒç”¨æˆå‘˜å¯¹è±¡çš„æ“ä½œã€‚
3. å¤ç”¨çš„çµæ´»æ€§é«˜ã€‚è¿™ç§å¤ç”¨å¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€è¿›è¡Œï¼Œ<strong style="color:#ae3520;">æ–°å¯¹è±¡å¯ä»¥åŠ¨æ€çš„å¼•ç”¨ä¸æˆå‘˜å¯¹è±¡ç±»å‹ç›¸åŒçš„å…¶ä»–å¯¹è±¡</strong>ã€‚

ä¸¾ä¸ªæ —å­ï¼šæ±½è½¦æŒ‰ç…§åŠ¨åŠ›æºå¯ä»¥åˆ†ä¸ºæ±½æ²¹æ±½è½¦ã€ç”µåŠ¨æ±½è½¦ç­‰ï¼›æŒ‰ç…§é¢œè‰²å¯ä»¥åˆ†ä¸ºç™½è‰²æ±½è½¦ã€é»‘è‰²æ±½è½¦ç­‰ã€‚å¦‚æœåŒæ—¶è€ƒè™‘è¿™ä¸¤ç§åˆ†ç±»çš„è¯ï¼Œå…¶ç»„åˆå°±ä¼šæœ‰å¾ˆå¤šç§ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºæ˜¯ç”¨ç»§æ‰¿å…³ç³»å®ç°çš„æ±½è½¦åˆ†ç±»çš„ç±»ç»“æ„å›¾ï¼š

```plantuml
@startuml

class Car {
	+ move(): void
}

class GasolineCar extends Car {
	+ move(): void
}

class ElecricCar extends Car {
	+ move(): void
}

class WhiteGasolineCar extends GasolineCar {
	+ move(): void
}

class BlackGasolineCar extends GasolineCar {
	+ move(): void
}

class WhiteElecricCar extends ElecricCar {
	+ move(): void
}

class BlackElecricCar extends ElecricCar {
	+ move(): void
}

@enduml
```

ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºç”¨ç»§æ‰¿å…³ç³»å®ç°ä¼šäº§ç”Ÿå¾ˆå¤šçš„å­ç±»ï¼Œè€Œä¸”å¢åŠ æ–°çš„åŠ¨åŠ›æºå’Œé¢œè‰²æ—¶ä¼šå¢åŠ æ›´å¤šçš„å­ç±»ï¼Œå¯ä»¥å‘ç°æ‰©å±•èµ·æ¥æ˜¯éå¸¸éº»çƒ¦çš„ï¼Œå› æ­¤å’±ä»¬å¯ä»¥ä½¿ç”¨åˆæˆå¤ç”¨æ¥æ”¹è¿›ä¸€ä¸‹ä»£ç ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

```plantuml
@startuml

interface Energy {}

class Gasoline implements Energy {}

class Electric implements Energy {}

interface Color {}

class White implements Color {}

class Black implements Color {}

class Car {
	- energy: Energy
	- color: Color
	+ move(): void
}

Car o--> Energy
Car o--> Color

@enduml
```

