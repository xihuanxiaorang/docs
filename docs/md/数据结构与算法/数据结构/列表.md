# åˆ—è¡¨

åˆ—è¡¨ï¼ˆlistï¼‰æ˜¯ä¸€ä¸ª**æŠ½è±¡çš„**æ•°æ®ç»“æ„æ¦‚å¿µï¼Œå®ƒè¡¨ç¤ºå…ƒç´ çš„æœ‰åºé›†åˆï¼Œæ”¯æŒå…ƒç´ è®¿é—®ã€ä¿®æ”¹ã€æ·»åŠ ã€åˆ é™¤å’Œéå†ç­‰æ“ä½œï¼Œ<strong style="color:#ae3520;">æ— é¡»ä½¿ç”¨è€…è€ƒè™‘å®¹é‡é™åˆ¶çš„é—®é¢˜</strong>ã€‚åˆ—è¡¨å¯ä»¥åŸºäºé“¾è¡¨æˆ–æ•°ç»„å®ç°ã€‚

- é“¾è¡¨å¤©ç„¶å¯ä»¥çœ‹ä½œä¸€ä¸ªåˆ—è¡¨ï¼Œå…¶æ”¯æŒå…ƒç´ å¢åˆ æŸ¥æ”¹æ“ä½œï¼Œå¹¶ä¸”å¯ä»¥çµæ´»åŠ¨æ€æ‰©å®¹ã€‚
- æ•°ç»„ä¹Ÿæ”¯æŒå…ƒç´ å¢åˆ æŸ¥æ”¹ï¼Œä½†ç”±äºå…¶é•¿åº¦ä¸å¯å˜ï¼Œå› æ­¤åªèƒ½çœ‹ä½œä¸€ä¸ªå…·æœ‰é•¿åº¦é™åˆ¶çš„åˆ—è¡¨ã€‚

å½“ä½¿ç”¨æ•°ç»„å®ç°åˆ—è¡¨æ—¶ï¼Œ**é•¿åº¦ä¸å¯å˜çš„æ€§è´¨ä¼šå¯¼è‡´åˆ—è¡¨çš„å®ç”¨æ€§é™ä½**ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬é€šå¸¸æ— æ³•äº‹å…ˆç¡®å®šéœ€è¦å­˜å‚¨å¤šå°‘æ•°æ®ï¼Œä»è€Œéš¾ä»¥é€‰æ‹©åˆé€‚çš„åˆ—è¡¨é•¿åº¦ã€‚è‹¥é•¿åº¦è¿‡å°ï¼Œåˆ™å¾ˆå¯èƒ½æ— æ³•æ»¡è¶³ä½¿ç”¨éœ€æ±‚ï¼›è‹¥é•¿åº¦è¿‡å¤§ï¼Œåˆ™ä¼šé€ æˆå†…å­˜ç©ºé—´æµªè´¹ã€‚

ä¸ºè§£å†³æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨**åŠ¨æ€æ•°ç»„ï¼ˆdynamic arrayï¼‰**æ¥å®ç°åˆ—è¡¨ã€‚å®ƒç»§æ‰¿äº†æ•°ç»„çš„å„é¡¹ä¼˜ç‚¹ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­è¿›è¡Œ**åŠ¨æ€æ‰©å®¹**ã€‚

å®é™…ä¸Šï¼Œ**è®¸å¤šç¼–ç¨‹è¯­è¨€ä¸­çš„æ ‡å‡†åº“æä¾›çš„åˆ—è¡¨æ˜¯åŸºäºåŠ¨æ€æ•°ç»„å®ç°çš„**ï¼Œä¾‹å¦‚ Python ä¸­çš„ `list` ã€Java ä¸­çš„ `ArrayList` ã€C++ ä¸­çš„ `vector` å’Œ C# ä¸­çš„ `List` ç­‰ã€‚åœ¨æ¥ä¸‹æ¥çš„è®¨è®ºä¸­ï¼Œæˆ‘ä»¬å°†æŠŠâ€œåˆ—è¡¨â€å’Œâ€œåŠ¨æ€æ•°ç»„â€è§†ä¸ºç­‰åŒçš„æ¦‚å¿µã€‚

## åˆ—è¡¨å¸¸ç”¨æ“ä½œ

### åˆå§‹åŒ–åˆ—è¡¨

æˆ‘ä»¬é€šå¸¸ä½¿ç”¨â€œæ— åˆå§‹å€¼â€å’Œâ€œæœ‰åˆå§‹å€¼â€è¿™ä¸¤ç§åˆå§‹åŒ–æ–¹æ³•ï¼š

```java
/* åˆå§‹åŒ–åˆ—è¡¨ */
// æ— åˆå§‹å€¼
List<Integer> nums1 = new ArrayList<>();
// æœ‰åˆå§‹å€¼ï¼ˆæ³¨æ„æ•°ç»„çš„å…ƒç´ ç±»å‹éœ€ä¸º int[] çš„åŒ…è£…ç±» Integer[]ï¼‰
Integer[] numbers = new Integer[] { 1, 3, 2, 5, 4 };
List<Integer> nums = new ArrayList<>(Arrays.asList(numbers));
```

### è®¿é—®å…ƒç´ 

<strong style="color:#ae3520;">åˆ—è¡¨æœ¬è´¨ä¸Šæ˜¯æ•°ç»„</strong>ï¼Œå› æ­¤å¯ä»¥åœ¨ ğ‘‚(1) æ—¶é—´å†…è®¿é—®å’Œæ›´æ–°å…ƒç´ ï¼Œæ•ˆç‡å¾ˆé«˜ã€‚

```java
/* è®¿é—®å…ƒç´  */
int num = nums.get(1);  // è®¿é—®ç´¢å¼• 1 å¤„çš„å…ƒç´ 

/* æ›´æ–°å…ƒç´  */
nums.set(1, 0);  // å°†ç´¢å¼• 1 å¤„çš„å…ƒç´ æ›´æ–°ä¸º 0
```

### æ’å…¥ä¸åˆ é™¤å…ƒç´ 

ç›¸è¾ƒäºæ•°ç»„ï¼Œåˆ—è¡¨å¯ä»¥è‡ªç”±åœ°æ·»åŠ ä¸åˆ é™¤å…ƒç´ ã€‚åœ¨åˆ—è¡¨å°¾éƒ¨æ·»åŠ å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º ğ‘‚(1) ï¼Œä½†æ’å…¥å’Œåˆ é™¤å…ƒç´ çš„æ•ˆç‡ä»ä¸æ•°ç»„ç›¸åŒï¼Œæ—¶é—´å¤æ‚åº¦ä¸º ğ‘‚(ğ‘›) ã€‚

```java
/* æ¸…ç©ºåˆ—è¡¨ */
nums.clear();

/* åœ¨å°¾éƒ¨æ·»åŠ å…ƒç´  */
nums.add(1);
nums.add(3);
nums.add(2);
nums.add(5);
nums.add(4);

/* åœ¨ä¸­é—´æ’å…¥å…ƒç´  */
nums.add(3, 6);  // åœ¨ç´¢å¼• 3 å¤„æ’å…¥æ•°å­— 6

/* åˆ é™¤å…ƒç´  */
nums.remove(3);  // åˆ é™¤ç´¢å¼• 3 å¤„çš„å…ƒç´ 
```

### éå†åˆ—è¡¨

ä¸æ•°ç»„ä¸€æ ·ï¼Œåˆ—è¡¨å¯ä»¥æ ¹æ®ç´¢å¼•éå†ï¼Œä¹Ÿå¯ä»¥ç›´æ¥éå†å„å…ƒç´ ã€‚

```java
/* é€šè¿‡ç´¢å¼•éå†åˆ—è¡¨ */
int count = 0;
for (int i = 0; i < nums.size(); i++) {
    count += nums.get(i);
}

/* ç›´æ¥éå†åˆ—è¡¨å…ƒç´ ï¼Œå¢å¼ºforå¾ªç¯ */
for (int num : nums) {
    count += num;
}
```

### æ‹¼æ¥åˆ—è¡¨

ç»™å®šä¸€ä¸ªæ–°åˆ—è¡¨ `nums1` ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æ‹¼æ¥åˆ°åŸåˆ—è¡¨çš„å°¾éƒ¨ã€‚

```java
/* æ‹¼æ¥ä¸¤ä¸ªåˆ—è¡¨ */
List<Integer> nums1 = new ArrayList<>(Arrays.asList(new Integer[] { 6, 8, 7, 10, 9 }));
nums.addAll(nums1);  // å°†åˆ—è¡¨ nums1 æ‹¼æ¥åˆ° nums ä¹‹å
```

### æ’åºåˆ—è¡¨

å®Œæˆåˆ—è¡¨æ’åºåï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ä½¿ç”¨åœ¨æ•°ç»„ç±»ç®—æ³•é¢˜ä¸­ç»å¸¸è€ƒæŸ¥çš„â€œäºŒåˆ†æŸ¥æ‰¾â€å’Œâ€œåŒæŒ‡é’ˆâ€ç®—æ³•ã€‚

```java
/* æ’åºåˆ—è¡¨ */
Collections.sort(nums);  // æ’åºåï¼Œåˆ—è¡¨å…ƒç´ ä»å°åˆ°å¤§æ’åˆ—
```

## åˆ—è¡¨å®ç°

è®¸å¤šç¼–ç¨‹è¯­è¨€å†…ç½®äº†åˆ—è¡¨ï¼Œä¾‹å¦‚ Javaã€C++ã€Python ç­‰ã€‚å®ƒä»¬çš„å®ç°æ¯”è¾ƒå¤æ‚ï¼Œå„ä¸ªå‚æ•°çš„è®¾å®šä¹Ÿéå¸¸è€ƒç©¶ï¼Œä¾‹å¦‚**åˆå§‹å®¹é‡**ã€**æ‰©å®¹å€æ•°**ç­‰ã€‚æ„Ÿå…´è¶£çš„è¯»è€…å¯ä»¥æŸ¥é˜…æºç è¿›è¡Œå­¦ä¹ ã€‚

ä¸ºäº†åŠ æ·±å¯¹åˆ—è¡¨å·¥ä½œåŸç†çš„ç†è§£ï¼Œæˆ‘ä»¬å°è¯•å®ç°ä¸€ä¸ªç®€æ˜“ç‰ˆåˆ—è¡¨ï¼ŒåŒ…æ‹¬ä»¥ä¸‹ä¸‰ä¸ªé‡ç‚¹è®¾è®¡ã€‚

- **åˆå§‹å®¹é‡**ï¼šé€‰å–ä¸€ä¸ªåˆç†çš„æ•°ç»„åˆå§‹å®¹é‡ã€‚åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é€‰æ‹© 10 ä½œä¸ºåˆå§‹å®¹é‡ã€‚
- **æ•°é‡è®°å½•**ï¼šå£°æ˜ä¸€ä¸ªå˜é‡ `size` ï¼Œç”¨äºè®°å½•åˆ—è¡¨å½“å‰å…ƒç´ æ•°é‡ï¼Œå¹¶éšç€å…ƒç´ æ’å…¥å’Œåˆ é™¤å®æ—¶æ›´æ–°ã€‚æ ¹æ®æ­¤å˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥å®šä½åˆ—è¡¨å°¾éƒ¨ï¼Œä»¥åŠåˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ã€‚
- **æ‰©å®¹æœºåˆ¶**ï¼šè‹¥æ’å…¥å…ƒç´ æ—¶åˆ—è¡¨å®¹é‡å·²æ»¡ï¼Œåˆ™éœ€è¦è¿›è¡Œæ‰©å®¹ã€‚å…ˆæ ¹æ®æ‰©å®¹å€æ•°åˆ›å»ºä¸€ä¸ªæ›´å¤§çš„æ•°ç»„ï¼Œå†å°†å½“å‰æ•°ç»„çš„æ‰€æœ‰å…ƒç´ ä¾æ¬¡ç§»åŠ¨è‡³æ–°æ•°ç»„ã€‚åœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬è§„å®šæ¯æ¬¡å°†æ•°ç»„æ‰©å®¹è‡³ä¹‹å‰çš„ 2 å€ã€‚

::: code-group

```java [ä»£ç å®ç°]
public class ArrayList {
  /**
   * æ¯æ¬¡åˆ—è¡¨æ‰©å¤§çš„å€æ•°
   */
  private final int extendRatio = 2;
  /**
   * åˆ—è¡¨å®¹é‡
   */
  private int capacity = 10;
  /**
   * æ•°ç»„ï¼ˆå­˜å‚¨åˆ—è¡¨å…ƒç´ ï¼‰
   */
  private int[] arr;
  /**
   * åˆ—è¡¨é•¿åº¦ï¼ˆå½“å‰å…ƒç´ æ•°é‡ï¼‰
   */
  private int size = 0;

  public ArrayList() {
    arr = new int[capacity];
  }

  /**
   * è·å–åˆ—è¡¨é•¿åº¦ï¼ˆå½“å‰å…ƒç´ æ•°é‡ï¼‰
   *
   * @return åˆ—è¡¨é•¿åº¦ï¼ˆå½“å‰å…ƒç´ æ•°é‡ï¼‰
   */
  public int size() {
    return size;
  }

  /**
   * è·å–åˆ—è¡¨å®¹é‡
   *
   * @return åˆ—è¡¨å®¹é‡
   */
  public int capacity() {
    return capacity;
  }

  /**
   * è®¿é—®å…ƒç´ 
   *
   * @param index ç´¢å¼•
   * @return å…ƒç´ 
   */
  public int get(int index) {
    if (index < 0 || index >= size) {
      throw new IndexOutOfBoundsException("ç´¢å¼•è¶Šç•Œ");
    }
    return arr[index];
  }

  /**
   * æ›´æ–°å…ƒç´ 
   *
   * @param index   ç´¢å¼•
   * @param element å…ƒç´ 
   */
  public void set(int index, int element) {
    if (index < 0 || index >= size) {
      throw new IndexOutOfBoundsException("ç´¢å¼•è¶Šç•Œ");
    }
    arr[index] = element;
  }

  /**
   * åœ¨åˆ—è¡¨æœ«å°¾æ·»åŠ å…ƒç´ 
   *
   * @param element å…ƒç´ 
   */
  public void add(int element) {
    // å…ƒç´ æ•°é‡è¶…å‡ºå®¹é‡æ—¶ï¼Œè§¦å‘æ‰©å®¹æœºåˆ¶
    if (size == capacity) {
      extendCapacity();
    }
    arr[size++] = element;
  }

  /**
   * åœ¨åˆ—è¡¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ 
   *
   * @param index   ç´¢å¼•
   * @param element å…ƒç´ 
   */
  public void insert(int index, int element) {
    if (index < 0 || index > size) {
      throw new IndexOutOfBoundsException("ç´¢å¼•è¶Šç•Œ");
    }
    // å…ƒç´ æ•°é‡è¶…å‡ºå®¹é‡æ—¶ï¼Œè§¦å‘æ‰©å®¹æœºåˆ¶
    if (size == capacity) {
      extendCapacity();
    }
    // åˆ—è¡¨ä¸­çš„å…ƒç´ æ•´ä½“å‘åç§»åŠ¨ä¸€ä½
    System.arraycopy(arr, index, arr, index + 1, size - index);
    // æ’å…¥æ–°å…ƒç´ 
    arr[index] = element;
    // åˆ—è¡¨é•¿åº¦åŠ  1
    size++;
  }

  /**
   * åˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ å¹¶è¿”å›è¯¥å…ƒç´ 
   *
   * @param index ç´¢å¼•
   * @return è¢«åˆ é™¤çš„å…ƒç´ 
   */
  public int remove(int index) {
    if (index < 0 || index >= size) {
      throw new IndexOutOfBoundsException("ç´¢å¼•è¶Šç•Œ");
    }
    // è®°å½•è¢«åˆ é™¤çš„å…ƒç´ 
    int num = arr[index];
    // åˆ—è¡¨ä¸­çš„å…ƒç´ æ•´ä½“å‘å‰ç§»åŠ¨ä¸€ä½
    System.arraycopy(arr, index + 1, arr, index, size - index - 1);
    // åˆ—è¡¨é•¿åº¦å‡ 1
    size--;
    // è¿”å›è¢«åˆ é™¤çš„å…ƒç´ 
    return num;
  }

  /**
   * å°†åˆ—è¡¨è½¬æ¢ä¸ºæ•°ç»„
   *
   * @return æ•°ç»„
   */
  public int[] toArray() {
    // ä»…è½¬æ¢æœ‰æ•ˆé•¿åº¦èŒƒå›´å†…çš„åˆ—è¡¨å…ƒç´ 
    int[] res = new int[size];
    // å°†æœ‰æ•ˆé•¿åº¦èŒƒå›´å†…çš„å…ƒç´ å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­
    System.arraycopy(arr, 0, res, 0, size);
    return res;
  }

  /**
   * åˆ—è¡¨æ‰©å®¹
   */
  private void extendCapacity() {
    // æ–°æ•°ç»„å®¹é‡ä¸ºåŸæ•°ç»„å®¹é‡çš„ extendRatio å€
    int newCapacity = capacity * extendRatio;
    // åˆ›å»ºä¸€ä¸ªé•¿åº¦ä¸ºåŸæ•°ç»„ extendRatio å€çš„æ–°æ•°ç»„
    int[] newArr = new int[newCapacity];
    // å°†åŸæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­
    System.arraycopy(arr, 0, newArr, 0, size);
    // åŸæ•°ç»„å¼•ç”¨æŒ‡å‘æ–°æ•°ç»„
    arr = newArr;
    // æ–°æ•°ç»„å®¹é‡è®¾ç½®ä¸ºåŸæ•°ç»„å®¹é‡çš„ extendRatio å€
    capacity = newCapacity;
  }
}
```

```java [æµ‹è¯•]
class ArrayListTest {
  @Test
  public void test() {
    ArrayList list = new ArrayList();
    list.add(1);
    list.add(3);
    list.add(2);
    list.add(5);
    list.add(4);
    Assertions.assertArrayEquals(new int[]{1, 3, 2, 5, 4}, list.toArray());
    Assertions.assertEquals(2, list.get(2));
    Assertions.assertEquals(5, list.remove(3)); // 1, 3, 2, 4
    Assertions.assertEquals(4, list.size());
    list.set(3, 6);
    Assertions.assertEquals(6, list.get(3)); // 1, 3, 2, 6
    list.insert(4, 7); // 1, 3, 2, 6, 7
    list.insert(0, 8); // 8, 1, 3, 2, 6, 7
    Assertions.assertArrayEquals(new int[]{8, 1, 3, 2, 6, 7}, list.toArray());
  }
}
```

:::

