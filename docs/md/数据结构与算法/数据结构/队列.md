# é˜Ÿåˆ—

é˜Ÿåˆ—ï¼ˆqueueï¼‰æ˜¯ä¸€ç§éµå¾ª<strong style="color:#ae3520;">å…ˆå…¥å…ˆå‡º</strong>è§„åˆ™çš„çº¿æ€§æ•°æ®ç»“æ„ã€‚é¡¾åæ€ä¹‰ï¼Œé˜Ÿåˆ—æ¨¡æ‹Ÿäº†æ’é˜Ÿç°è±¡ï¼Œå³æ–°æ¥çš„äººä¸æ–­åŠ å…¥é˜Ÿåˆ—å°¾éƒ¨ï¼Œè€Œä½äºé˜Ÿåˆ—å¤´éƒ¨çš„äººé€ä¸ªç¦»å¼€ã€‚

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬<strong style="color:#ae3520;">å°†é˜Ÿåˆ—å¤´éƒ¨ç§°ä¸ºâ€œé˜Ÿé¦–â€ï¼Œå°¾éƒ¨ç§°ä¸ºâ€œé˜Ÿå°¾â€ï¼Œå°†æŠŠå…ƒç´ åŠ å…¥é˜Ÿå°¾çš„æ“ä½œç§°ä¸ºâ€œå…¥é˜Ÿâ€ï¼Œåˆ é™¤é˜Ÿé¦–å…ƒç´ çš„æ“ä½œç§°ä¸ºâ€œå‡ºé˜Ÿâ€</strong>ã€‚

![queue_operations](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406112254916.png)

## é˜Ÿåˆ—å¸¸ç”¨æ“ä½œ

é˜Ÿåˆ—çš„å¸¸è§æ“ä½œå¦‚ä¸‹è¡¨ï¼ˆé˜Ÿåˆ—æ“ä½œæ•ˆç‡ï¼‰æ‰€ç¤ºã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸åŒç¼–ç¨‹è¯­è¨€çš„æ–¹æ³•åç§°å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚æˆ‘ä»¬åœ¨æ­¤é‡‡ç”¨ä¸æ ˆç›¸åŒçš„æ–¹æ³•å‘½åã€‚

| æ–¹æ³•å   | æè¿°                         | æ—¶é—´å¤æ‚åº¦ |
| :------- | :--------------------------- | :--------- |
| `push()` | å…ƒç´ å…¥é˜Ÿï¼Œå³å°†å…ƒç´ æ·»åŠ è‡³é˜Ÿå°¾ | ğ‘‚(1)       |
| `pop()`  | é˜Ÿé¦–å…ƒç´ å‡ºé˜Ÿ                 | ğ‘‚(1)       |
| `peek()` | è®¿é—®é˜Ÿé¦–å…ƒç´                  | ğ‘‚(1)       |

æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼–ç¨‹è¯­è¨€ä¸­ç°æˆçš„é˜Ÿåˆ—ç±»ï¼š

```java
/* åˆå§‹åŒ–é˜Ÿåˆ— */
Queue<Integer> queue = new LinkedList<>();

/* å…ƒç´ å…¥é˜Ÿ */
queue.offer(1);
queue.offer(3);
queue.offer(2);
queue.offer(5);
queue.offer(4);

/* è®¿é—®é˜Ÿé¦–å…ƒç´  */
int peek = queue.peek();

/* å…ƒç´ å‡ºé˜Ÿ */
int pop = queue.poll();

/* è·å–é˜Ÿåˆ—çš„é•¿åº¦ */
int size = queue.size();

/* åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º */
boolean isEmpty = queue.isEmpty();
```

## é˜Ÿåˆ—å®ç°

ä¸ºäº†å®ç°é˜Ÿåˆ—ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§æ•°æ®ç»“æ„ï¼Œå¯ä»¥åœ¨ä¸€ç«¯æ·»åŠ å…ƒç´ ï¼Œå¹¶åœ¨å¦ä¸€ç«¯åˆ é™¤å…ƒç´ ï¼Œé“¾è¡¨å’Œæ•°ç»„éƒ½ç¬¦åˆè¦æ±‚ã€‚

### åŸºäºé“¾è¡¨çš„å®ç°

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥å°†é“¾è¡¨çš„â€œå¤´èŠ‚ç‚¹â€å’Œâ€œå°¾èŠ‚ç‚¹â€åˆ†åˆ«è§†ä¸ºâ€œé˜Ÿé¦–â€å’Œâ€œé˜Ÿå°¾â€ï¼Œè§„å®šé˜Ÿå°¾ä»…å¯æ·»åŠ èŠ‚ç‚¹ï¼Œé˜Ÿé¦–ä»…å¯åˆ é™¤èŠ‚ç‚¹ã€‚

![image-20240611230453692](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406112304755.png)

![image-20240611230611828](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406112306884.png)

![image-20240611230646028](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406112306082.png)

ä»¥ä¸‹æ˜¯ç”¨é“¾è¡¨å®ç°é˜Ÿåˆ—çš„ä»£ç ï¼š

::: code-group

```java [ä»£ç å®ç°]
public class LinkedListQueue<E> {
  /**
   * é˜Ÿåˆ—çš„é•¿åº¦
   */
  private int size = 0;
  /**
   * å¤´æŒ‡é’ˆï¼ŒæŒ‡å‘é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
   */
  private ListNode<E> front;
  /**
   * å°¾æŒ‡é’ˆï¼ŒæŒ‡å‘é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ 
   */
  private ListNode<E> rear;

  /**
   * è·å–é˜Ÿåˆ—çš„é•¿åº¦
   *
   * @return é˜Ÿåˆ—çš„é•¿åº¦
   */
  public int size() {
    return size;
  }

  /**
   * åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º
   *
   * @return true é˜Ÿåˆ—ä¸ºç©ºï¼Œfalse é˜Ÿåˆ—ä¸ä¸ºç©º
   */
  public boolean isEmpty() {
    return size() == 0;
  }

  /**
   * å…¥é˜Ÿæ“ä½œï¼Œå°†å…ƒç´ eæ·»åŠ åˆ°é˜Ÿåˆ—çš„å°¾éƒ¨
   *
   * @param e å…¥é˜Ÿå…ƒç´ 
   */
  public void push(E e) {
    ListNode<E> newNode = new ListNode<>(e);
    if (front == null) {
      front = newNode;
    } else {
      rear.next = newNode;
    }
    rear = newNode;
    size++;
  }

  /**
   * å‡ºé˜Ÿæ“ä½œï¼Œåˆ é™¤é˜Ÿé¦–å…ƒç´ å¹¶è¿”å›
   *
   * @return é˜Ÿé¦–å…ƒç´ 
   */
  public E pop() {
    // è·å–é˜Ÿé¦–å…ƒç´ 
    E top = peek();
    // å°†å¤´æŒ‡é’ˆæŒ‡å‘é˜Ÿé¦–å…ƒç´ çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
    front = front.next;
    // é˜Ÿåˆ—é•¿åº¦å‡ä¸€
    size--;
    // è¿”å›é˜Ÿé¦–å…ƒç´ 
    return top;
  }

  /**
   * è·å–é˜Ÿé¦–å…ƒç´ 
   *
   * @return é˜Ÿé¦–å…ƒç´ 
   */
  public E peek() {
    if (isEmpty()) {
      throw new NoSuchElementException();
    }
    return front.value;
  }

  /**
   * å°†é˜Ÿåˆ—ä¸­çš„å…ƒç´ è½¬åŒ–ä¸ºæ•°ç»„
   *
   * @return é˜Ÿåˆ—ä¸­çš„å…ƒç´ ç»„æˆçš„æ•°ç»„
   */
  public Object[] toArray() {
    ListNode<E> curr = front;
    Object[] res = new Object[size()];
    for (int i = 0; i < size(); i++) {
      res[i] = curr.value;
      curr = curr.next;
    }
    return res;
  }

  private static class ListNode<E> {
    /**
     * èŠ‚ç‚¹å€¼
     */
    E value;
    /**
     * æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ
     */
    ListNode<E> next;

    /**
     * æ„é€ å‡½æ•°
     *
     * @param value èŠ‚ç‚¹å€¼
     */
    public ListNode(E value) {
      this.value = value;
    }
  }
}
```

```java [æµ‹è¯•]
class LinkedListQueueTest {
  @Test
  public void test() {
    LinkedListQueue<Integer> queue = new LinkedListQueue<>();
    queue.push(1);
    queue.push(3);
    queue.push(2);
    queue.push(5);
    queue.push(4);
    Assertions.assertArrayEquals(new Integer[]{1, 3, 2, 5, 4}, queue.toArray());
    Assertions.assertEquals(1, queue.peek());
    Assertions.assertEquals(1, queue.pop());
    Assertions.assertEquals(3, queue.peek());
    Assertions.assertEquals(4, queue.size());
    queue.pop();
    queue.pop();
    queue.pop();
    queue.pop();
    Assertions.assertTrue(queue.isEmpty());
  }
}
```

:::

### åŸºäºæ•°ç»„çš„å®ç°

åœ¨æ•°ç»„ä¸­åˆ é™¤é¦–å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦ä¸º ğ‘‚(ğ‘›) ï¼Œè¿™ä¼šå¯¼è‡´å‡ºé˜Ÿæ“ä½œæ•ˆç‡è¾ƒä½ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨ä»¥ä¸‹å·§å¦™æ–¹æ³•æ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå˜é‡ `front` æŒ‡å‘é˜Ÿé¦–å…ƒç´ çš„ç´¢å¼•ï¼Œå¹¶ç»´æŠ¤ä¸€ä¸ªå˜é‡ `size` ç”¨äºè®°å½•é˜Ÿåˆ—é•¿åº¦ã€‚å®šä¹‰ `rear = front + size` ï¼Œè¿™ä¸ªå…¬å¼è®¡ç®—å‡ºçš„ `rear` æŒ‡å‘é˜Ÿå°¾å…ƒç´ ä¹‹åçš„ä¸‹ä¸€ä¸ªä½ç½®ã€‚

åŸºäºæ­¤è®¾è®¡ï¼Œ**æ•°ç»„ä¸­åŒ…å«å…ƒç´ çš„æœ‰æ•ˆåŒºé—´ä¸º `[front, rear - 1]`**ï¼Œå„ç§æ“ä½œçš„å®ç°æ–¹æ³•å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚

- å…¥é˜Ÿæ“ä½œï¼šå°†è¾“å…¥å…ƒç´ èµ‹å€¼ç»™ `rear` ç´¢å¼•å¤„ï¼Œå¹¶å°† `size` å¢åŠ  1 ã€‚
- å‡ºé˜Ÿæ“ä½œï¼šåªéœ€å°† `front` å¢åŠ  1 ï¼Œå¹¶å°† `size` å‡å°‘ 1 ã€‚

å¯ä»¥çœ‹åˆ°ï¼Œå…¥é˜Ÿå’Œå‡ºé˜Ÿæ“ä½œéƒ½åªéœ€è¿›è¡Œä¸€æ¬¡æ“ä½œï¼Œæ—¶é—´å¤æ‚åº¦å‡ä¸º ğ‘‚(1) ã€‚

![image-20240611233729939](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406112337011.png)

![image-20240611233805699](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406112338772.png)

![array_queue_step3_pop](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406112338079.png)

ä½ å¯èƒ½ä¼šå‘ç°ä¸€ä¸ªé—®é¢˜ï¼šåœ¨ä¸æ–­è¿›è¡Œå…¥é˜Ÿå’Œå‡ºé˜Ÿçš„è¿‡ç¨‹ä¸­ï¼Œ`front` å’Œ `rear` éƒ½åœ¨å‘å³ç§»åŠ¨ï¼Œ**å½“å®ƒä»¬åˆ°è¾¾æ•°ç»„å°¾éƒ¨æ—¶å°±æ— æ³•ç»§ç»­ç§»åŠ¨äº†**ã€‚ä¸ºäº†è§£å†³æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•°ç»„è§†ä¸ºé¦–å°¾ç›¸æ¥çš„â€œç¯å½¢æ•°ç»„â€ã€‚

å¯¹äºç¯å½¢æ•°ç»„ï¼Œæˆ‘ä»¬éœ€è¦è®© `front` æˆ– `rear` åœ¨è¶Šè¿‡æ•°ç»„å°¾éƒ¨æ—¶ï¼Œç›´æ¥å›åˆ°æ•°ç»„å¤´éƒ¨ç»§ç»­éå†ã€‚è¿™ç§å‘¨æœŸæ€§è§„å¾‹å¯ä»¥é€šè¿‡â€œå–ä½™æ“ä½œâ€æ¥å®ç°ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š

::: code-group

```java [ä»£ç å®ç°]
public class ArrayQueue<E> {
  /**
   * ç”¨äºå­˜å‚¨é˜Ÿåˆ—å…ƒç´ çš„æ•°ç»„
   */
  private final Object[] elementData;
  /**
   * é˜Ÿå¤´æŒ‡é’ˆï¼ŒæŒ‡å‘é˜Ÿé¦–å…ƒç´ 
   */
  private int front;
  /**
   * é˜Ÿåˆ—çš„é•¿åº¦
   */
  private int size;

  public ArrayQueue() {
    this(10);
  }

  public ArrayQueue(int capacity) {
    elementData = new Object[capacity];
    front = size = 0;
  }

  /**
   * è·å–é˜Ÿåˆ—çš„å®¹é‡
   *
   * @return é˜Ÿåˆ—çš„å®¹é‡
   */
  public int capacity() {
    return elementData.length;
  }

  /**
   * è·å–é˜Ÿåˆ—çš„é•¿åº¦
   *
   * @return é˜Ÿåˆ—çš„é•¿åº¦
   */
  public int size() {
    return size;
  }

  /**
   * åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º
   *
   * @return trueï¼šé˜Ÿåˆ—ä¸ºç©ºï¼›falseï¼šé˜Ÿåˆ—ä¸ä¸ºç©º
   */
  public boolean isEmpty() {
    return size() == 0;
  }

  /**
   * å…¥é˜Ÿæ“ä½œï¼Œå°†å…ƒç´ eæ·»åŠ åˆ°é˜Ÿåˆ—çš„å°¾éƒ¨
   *
   * @param e å…¥é˜Ÿå…ƒç´ 
   */
  public void push(E e) {
    if (size() == capacity()) {
      throw new IllegalStateException("é˜Ÿåˆ—å·²æ»¡");
    }
    // è®¡ç®—é˜Ÿå°¾æŒ‡é’ˆï¼ŒæŒ‡å‘é˜Ÿå°¾å…ƒç´ çš„ä¸‹ä¸€ä¸ªä½ç½®
    // é€šè¿‡å–ä½™æ“ä½œå®ç° rear è¶Šè¿‡æ•°ç»„å°¾éƒ¨åå›åˆ°å¤´éƒ¨
    int rear = (front + size) % capacity();
    // å°†å…ƒç´ æ”¾å…¥é˜Ÿå°¾
    elementData[rear] = e;
    // é˜Ÿåˆ—é•¿åº¦åŠ  1
    size++;
  }

  /**
   * å‡ºé˜Ÿæ“ä½œï¼Œè¿”å›é˜Ÿé¦–å…ƒç´ 
   *
   * @return é˜Ÿé¦–å…ƒç´ 
   */
  public E pop() {
    // è·å–é˜Ÿé¦–å…ƒç´ 
    E top = peek();
    // é˜Ÿé¦–æŒ‡é’ˆå‘åç§»åŠ¨ä¸€ä½ï¼Œè‹¥è¶Šè¿‡å°¾éƒ¨ï¼Œåˆ™è¿”å›åˆ°æ•°ç»„å¤´éƒ¨
    front = (front + 1) % capacity();
    // é˜Ÿåˆ—é•¿åº¦å‡ 1
    size--;
    // è¿”å›é˜Ÿé¦–å…ƒç´ 
    return top;
  }

  /**
   * è·å–é˜Ÿé¦–å…ƒç´ 
   *
   * @return é˜Ÿé¦–å…ƒç´ 
   */
  public E peek() {
    if (isEmpty()) {
      throw new IndexOutOfBoundsException();
    }
    return elementData(front);
  }

  /**
   * å°†é˜Ÿåˆ—ä¸­çš„å…ƒç´ è½¬åŒ–ä¸ºæ•°ç»„
   *
   * @return é˜Ÿåˆ—ä¸­çš„å…ƒç´ ç»„æˆçš„æ•°ç»„
   */
  public Object[] toArray() {
    // ä»…è½¬æ¢æœ‰æ•ˆé•¿åº¦èŒƒå›´å†…çš„åˆ—è¡¨å…ƒç´ 
    Object[] res = new Object[size()];
    // å°†æœ‰æ•ˆé•¿åº¦èŒƒå›´å†…çš„å…ƒç´ å¤åˆ¶åˆ°æ–°æ•°ç»„ä¸­
    for (int i = 0, j = front; i < size(); i++, j++) {
      res[i] = elementData(j % capacity());
    }
    return res;
  }

  @SuppressWarnings("unchecked")
  E elementData(int index) {
    return (E) elementData[index];
  }
}
```

```java [æµ‹è¯•]
class ArrayQueueTest {
  @Test
  public void test() {
    ArrayQueue<Integer> queue = new ArrayQueue<>();
    queue.push(1);
    queue.push(3);
    queue.push(2);
    queue.push(5);
    queue.push(4);
    Assertions.assertArrayEquals(new Integer[]{1, 3, 2, 5, 4}, queue.toArray());
    Assertions.assertEquals(1, queue.peek());
    Assertions.assertEquals(1, queue.pop());
    Assertions.assertEquals(3, queue.peek());
    Assertions.assertEquals(4, queue.size());
    queue.pop();
    queue.pop();
    queue.pop();
    queue.pop();
    Assertions.assertTrue(queue.isEmpty());
  }
}
```

:::

ä»¥ä¸Šå®ç°çš„é˜Ÿåˆ—ä»ç„¶å…·æœ‰å±€é™æ€§ï¼šå…¶é•¿åº¦ä¸å¯å˜ã€‚ç„¶è€Œï¼Œè¿™ä¸ªé—®é¢˜ä¸éš¾è§£å†³ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•°ç»„æ›¿æ¢ä¸ºåŠ¨æ€æ•°ç»„ï¼Œä»è€Œå¼•å…¥æ‰©å®¹æœºåˆ¶ã€‚æœ‰å…´è¶£çš„è¯»è€…å¯ä»¥å°è¯•è‡ªè¡Œå®ç°ã€‚

ä¸¤ç§å®ç°çš„å¯¹æ¯”ç»“è®ºä¸æ ˆä¸€è‡´ï¼Œåœ¨æ­¤ä¸å†èµ˜è¿°ã€‚

## é˜Ÿåˆ—å…¸å‹åº”ç”¨

- **æ·˜å®è®¢å•**ã€‚è´­ç‰©è€…ä¸‹å•åï¼Œè®¢å•å°†åŠ å…¥é˜Ÿåˆ—ä¸­ï¼Œç³»ç»Ÿéšåä¼šæ ¹æ®é¡ºåºå¤„ç†é˜Ÿåˆ—ä¸­çš„è®¢å•ã€‚åœ¨åŒåä¸€æœŸé—´ï¼ŒçŸ­æ—¶é—´å†…ä¼šäº§ç”Ÿæµ·é‡è®¢å•ï¼Œé«˜å¹¶å‘æˆä¸ºå·¥ç¨‹å¸ˆä»¬éœ€è¦é‡ç‚¹æ”»å…‹çš„é—®é¢˜ã€‚
- **å„ç±»å¾…åŠäº‹é¡¹**ã€‚ä»»ä½•éœ€è¦å®ç°â€œå…ˆæ¥ååˆ°â€åŠŸèƒ½çš„åœºæ™¯ï¼Œä¾‹å¦‚æ‰“å°æœºçš„ä»»åŠ¡é˜Ÿåˆ—ã€é¤å…çš„å‡ºé¤é˜Ÿåˆ—ç­‰ï¼Œé˜Ÿåˆ—åœ¨è¿™äº›åœºæ™¯ä¸­å¯ä»¥æœ‰æ•ˆåœ°ç»´æŠ¤å¤„ç†é¡ºåºã€‚