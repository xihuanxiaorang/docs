# æ ˆ

æ ˆï¼ˆstackï¼‰æ˜¯ä¸€ç§éµå¾ª<strong style="color:#ae3520;">å…ˆå…¥åå‡º</strong>é€»è¾‘çš„çº¿æ€§æ•°æ®ç»“æ„ã€‚

æˆ‘ä»¬å¯ä»¥å°†æ ˆç±»æ¯”ä¸ºæ¡Œé¢ä¸Šçš„ä¸€æ‘ç›˜å­ï¼Œå¦‚æœæƒ³å–å‡ºåº•éƒ¨çš„ç›˜å­ï¼Œåˆ™éœ€è¦å…ˆå°†ä¸Šé¢çš„ç›˜å­ä¾æ¬¡ç§»èµ°ã€‚æˆ‘ä»¬å°†ç›˜å­æ›¿æ¢ä¸ºå„ç§ç±»å‹çš„å…ƒç´ ï¼ˆå¦‚æ•´æ•°ã€å­—ç¬¦ã€å¯¹è±¡ç­‰ï¼‰ï¼Œå°±å¾—åˆ°äº†æ ˆè¿™ç§æ•°æ®ç»“æ„ã€‚

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬<strong style="color:#ae3520;">æŠŠå †å å…ƒç´ çš„é¡¶éƒ¨ç§°ä¸ºâ€œæ ˆé¡¶â€ï¼Œåº•éƒ¨ç§°ä¸ºâ€œæ ˆåº•â€ã€‚å°†æŠŠå…ƒç´ æ·»åŠ åˆ°æ ˆé¡¶çš„æ“ä½œå«ä½œâ€œå…¥æ ˆâ€ï¼Œåˆ é™¤æ ˆé¡¶å…ƒç´ çš„æ“ä½œå«ä½œâ€œå‡ºæ ˆâ€</strong>ã€‚

![image-20240611192655518](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406111926578.png)

## æ ˆçš„å¸¸ç”¨æ“ä½œ

æ ˆçš„å¸¸ç”¨æ“ä½œå¦‚ä¸‹è¡¨ï¼ˆæ ˆçš„æ“ä½œæ•ˆç‡ï¼‰æ‰€ç¤ºï¼Œå…·ä½“çš„æ–¹æ³•åéœ€è¦æ ¹æ®æ‰€ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€æ¥ç¡®å®šã€‚åœ¨æ­¤ï¼Œæˆ‘ä»¬ä»¥å¸¸è§çš„ `push()`ã€`pop()`ã€`peek()` å‘½åä¸ºä¾‹ã€‚

| æ–¹æ³•     | æè¿°                   | æ—¶é—´å¤æ‚åº¦ |
| :------- | :--------------------- | :--------- |
| `push()` | å…ƒç´ å…¥æ ˆï¼ˆæ·»åŠ è‡³æ ˆé¡¶ï¼‰ | ğ‘‚(1)       |
| `pop()`  | æ ˆé¡¶å…ƒç´ å‡ºæ ˆ           | ğ‘‚(1)       |
| `peek()` | è®¿é—®æ ˆé¡¶å…ƒç´            | ğ‘‚(1)       |

é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼–ç¨‹è¯­è¨€å†…ç½®çš„æ ˆç±»ã€‚ç„¶è€Œï¼ŒæŸäº›è¯­è¨€å¯èƒ½æ²¡æœ‰ä¸“é—¨æä¾›æ ˆç±»ï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥å°†è¯¥è¯­è¨€çš„â€œæ•°ç»„â€æˆ–â€œé“¾è¡¨â€å½“ä½œæ ˆæ¥ä½¿ç”¨ï¼Œå¹¶åœ¨ç¨‹åºé€»è¾‘ä¸Šå¿½ç•¥ä¸æ ˆæ— å…³çš„æ“ä½œã€‚

```java
/* åˆå§‹åŒ–æ ˆ */
Stack<Integer> stack = new Stack<>();

/* å…ƒç´ å…¥æ ˆ */
stack.push(1);
stack.push(3);
stack.push(2);
stack.push(5);
stack.push(4);

/* è®¿é—®æ ˆé¡¶å…ƒç´  */
int peek = stack.peek();

/* å…ƒç´ å‡ºæ ˆ */
int pop = stack.pop();

/* è·å–æ ˆçš„é•¿åº¦ */
int size = stack.size();

/* åˆ¤æ–­æ˜¯å¦ä¸ºç©º */
boolean isEmpty = stack.isEmpty();
```

## æ ˆçš„å®ç°

ä¸ºäº†æ·±å…¥äº†è§£æ ˆçš„è¿è¡Œæœºåˆ¶ï¼Œæˆ‘ä»¬æ¥å°è¯•è‡ªå·±å®ç°ä¸€ä¸ªæ ˆç±»ã€‚

æ ˆéµå¾ªå…ˆå…¥åå‡ºçš„åŸåˆ™ï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½åœ¨æ ˆé¡¶æ·»åŠ æˆ–åˆ é™¤å…ƒç´ ã€‚ç„¶è€Œï¼Œæ•°ç»„å’Œé“¾è¡¨éƒ½å¯ä»¥åœ¨ä»»æ„ä½ç½®æ·»åŠ å’Œåˆ é™¤å…ƒç´ ï¼Œå› æ­¤<strong style="color:#ae3520;">æ ˆå¯ä»¥è§†ä¸ºä¸€ç§å—é™åˆ¶çš„æ•°ç»„æˆ–é“¾è¡¨</strong>ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥â€œå±è”½â€æ•°ç»„æˆ–é“¾è¡¨çš„éƒ¨åˆ†æ— å…³æ“ä½œï¼Œä½¿å…¶å¯¹å¤–è¡¨ç°çš„é€»è¾‘ç¬¦åˆæ ˆçš„ç‰¹æ€§ã€‚

### åŸºäºé“¾è¡¨çš„å®ç°

ä½¿ç”¨é“¾è¡¨å®ç°æ ˆæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†é“¾è¡¨çš„å¤´èŠ‚ç‚¹è§†ä¸ºæ ˆé¡¶ï¼Œå°¾èŠ‚ç‚¹è§†ä¸ºæ ˆåº•ã€‚

å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯¹äºå…¥æ ˆæ“ä½œï¼Œæˆ‘ä»¬åªéœ€å°†å…ƒç´ æ’å…¥é“¾è¡¨å¤´éƒ¨ï¼Œè¿™ç§èŠ‚ç‚¹æ’å…¥æ–¹æ³•è¢«ç§°ä¸ºâ€œå¤´æ’æ³•â€ã€‚è€Œå¯¹äºå‡ºæ ˆæ“ä½œï¼Œåªéœ€å°†å¤´èŠ‚ç‚¹ä»é“¾è¡¨ä¸­åˆ é™¤å³å¯ã€‚

![image-20240611225812479](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406112258543.png)

![linkedlist_stack_step2_push](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406112259804.png)

![image-20240611230023147](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406112300207.png)

ä»¥ä¸‹æ˜¯åŸºäºé“¾è¡¨å®ç°æ ˆçš„ç¤ºä¾‹ä»£ç ï¼š

::: code-group

```java [ä»£ç å®ç°]
public class LinkedListStack<E> {
  /**
   * æ ˆçš„é•¿åº¦
   */
  private int size = 0;
  /**
   * æ ˆé¡¶æŒ‡é’ˆ
   */
  private ListNode<E> top;

  /**
   * è·å–æ ˆçš„é•¿åº¦
   *
   * @return æ ˆçš„é•¿åº¦
   */
  public int size() {
    return size;
  }

  /**
   * åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º
   *
   * @return true æ ˆä¸ºç©ºï¼Œfalse æ ˆä¸ä¸ºç©º
   */
  public boolean isEmpty() {
    return size == 0;
  }

  /**
   * å…¥æ ˆæ“ä½œï¼Œå°†å…ƒç´ å‹å…¥æ ˆä¸­
   *
   * @param element å¾…å‹å…¥çš„å…ƒç´ 
   */
  public void push(E element) {
    // åˆ›å»ºæ–°èŠ‚ç‚¹
    ListNode<E> newNode = new ListNode<>(element);
    // æ–°èŠ‚ç‚¹çš„ next æŒ‡é’ˆæŒ‡å‘æ ˆé¡¶
    newNode.next = top;
    // æ ˆé¡¶æŒ‡é’ˆæŒ‡å‘æ–°èŠ‚ç‚¹
    top = newNode;
    // æ ˆçš„é•¿åº¦åŠ ä¸€
    size++;
  }

  /**
   * å‡ºæ ˆæ“ä½œï¼Œå¼¹å‡ºæ ˆé¡¶å…ƒç´ 
   *
   * @return å¼¹å‡ºçš„æ ˆé¡¶å…ƒç´ 
   */
  public E pop() {
    // è·å–æ ˆé¡¶å…ƒç´ 
    E num = peek();
    // æ ˆé¡¶æŒ‡é’ˆæŒ‡å‘æ ˆé¡¶çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå³å°†æ ˆé¡¶å…ƒç´ çš„ä¸‹ä¸€ä¸ªå…ƒç´ ä½œä¸ºæ–°çš„æ ˆé¡¶
    top = top.next;
    // æ ˆçš„é•¿åº¦å‡ä¸€
    size--;
    // è¿”å›æ ˆé¡¶å…ƒç´ 
    return num;
  }

  /**
   * è·å–æ ˆé¡¶å…ƒç´ 
   *
   * @return æ ˆé¡¶å…ƒç´ 
   */
  public E peek() {
    if (isEmpty()) {
      throw new IndexOutOfBoundsException();
    }
    return top.value;
  }

  /**
   * å°†æ ˆä¸­çš„å…ƒç´ è½¬åŒ–ä¸ºæ•°ç»„
   *
   * @return æ ˆä¸­çš„å…ƒç´ ç»„æˆçš„æ•°ç»„
   */
  public Object[] toArray() {
    ListNode<E> cur = top;
    Object[] res = new Object[size];
    for (int i = size - 1; i >= 0; i--) {
      res[i] = cur.value;
      cur = cur.next;
    }
    return res;
  }

  private static class ListNode<E> {
    /**
     * èŠ‚ç‚¹å€¼
     */
    E value;
    /**
     * æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆ
     */
    ListNode<E> next;

    /**
     * æ„é€ å‡½æ•°
     *
     * @param value èŠ‚ç‚¹å€¼
     */
    public ListNode(E value) {
      this.value = value;
    }
  }
}
```

```java [æµ‹è¯•]
class LinkedListStackTest {
  @Test
  public void test() {
    LinkedListStack<Integer> stack = new LinkedListStack<>();
    stack.push(1);
    stack.push(3);
    stack.push(2);
    stack.push(5);
    stack.push(4);
    Assertions.assertArrayEquals(new Integer[]{1, 3, 2, 5, 4}, stack.toArray());
    Assertions.assertEquals(4, stack.peek());
    Assertions.assertEquals(4, stack.pop());
    Assertions.assertEquals(5, stack.peek());
    Assertions.assertEquals(4, stack.size());
    stack.pop();
    stack.pop();
    stack.pop();
    stack.pop();
    Assertions.assertTrue(stack.isEmpty());
  }
}
```

:::

### åŸºäºæ•°ç»„çš„å®ç°

ä½¿ç”¨æ•°ç»„å®ç°æ ˆæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•°ç»„çš„å°¾éƒ¨ä½œä¸ºæ ˆé¡¶ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå…¥æ ˆä¸å‡ºæ ˆæ“ä½œåˆ†åˆ«å¯¹åº”åœ¨æ•°ç»„å°¾éƒ¨æ·»åŠ å…ƒç´ ä¸åˆ é™¤å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦éƒ½ä¸º ğ‘‚(1) ã€‚

![image-20240611230143936](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406112301008.png)

![image-20240611230301131](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406112303207.png)

![image-20240611230342656](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img/202406112303731.png)

ç”±äºå…¥æ ˆçš„å…ƒç´ å¯èƒ½ä¼šæºæºä¸æ–­åœ°å¢åŠ ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠ¨æ€æ•°ç»„ï¼Œè¿™æ ·å°±æ— é¡»è‡ªè¡Œå¤„ç†æ•°ç»„æ‰©å®¹é—®é¢˜ã€‚ä»¥ä¸‹ä¸ºç¤ºä¾‹ä»£ç ï¼š

::: code-group

```java [ä»£ç å®ç°]
public class ArrayStack<E> {
  private final ArrayList<E> stack;

  public ArrayStack() {
    // åˆå§‹åŒ–ä¸€ä¸ªç©ºçš„åˆ—è¡¨ï¼ˆåŠ¨æ€æ•°ç»„ï¼‰ä½œä¸ºæ ˆ
    stack = new ArrayList<>();
  }

  /**
   * è·å–æ ˆçš„é•¿åº¦
   *
   * @return æ ˆçš„é•¿åº¦
   */
  public int size() {
    return stack.size();
  }

  /**
   * åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©º
   *
   * @return true æ ˆä¸ºç©ºï¼Œfalse æ ˆä¸ä¸ºç©º
   */
  public boolean isEmpty() {
    return size() == 0;
  }

  /**
   * å…¥æ ˆæ“ä½œï¼Œå°†å…ƒç´ å‹å…¥æ ˆä¸­
   *
   * @param element å¾…å‹å…¥çš„å…ƒç´ 
   */
  public void push(E element) {
    stack.add(element);
  }

  /**
   * å‡ºæ ˆæ“ä½œï¼Œå¼¹å‡ºæ ˆé¡¶å…ƒç´ 
   *
   * @return å¼¹å‡ºçš„æ ˆé¡¶å…ƒç´ 
   */
  public E pop() {
    if (isEmpty()) {
      throw new IndexOutOfBoundsException();
    }
    return stack.remove(size() - 1);
  }

  /**
   * è·å–æ ˆé¡¶å…ƒç´ 
   *
   * @return æ ˆé¡¶å…ƒç´ 
   */
  public E peek() {
    if (isEmpty()) {
      throw new IndexOutOfBoundsException();
    }
    return stack.get(size() - 1);
  }

  /**
   * å°†æ ˆä¸­çš„å…ƒç´ è½¬åŒ–ä¸ºæ•°ç»„
   *
   * @return æ ˆä¸­çš„å…ƒç´ ç»„æˆçš„æ•°ç»„
   */
  public Object[] toArray() {
    return stack.toArray();
  }
}
```

```java [æµ‹è¯•]
class ArrayStackTest {
  @Test
  public void test() {
    ArrayStack<Integer> stack = new ArrayStack<>();
    stack.push(1);
    stack.push(3);
    stack.push(2);
    stack.push(5);
    stack.push(4);
    Assertions.assertArrayEquals(new Integer[]{1, 3, 2, 5, 4}, stack.toArray());
    Assertions.assertEquals(4, stack.peek());
    Assertions.assertEquals(4, stack.pop());
    Assertions.assertEquals(5, stack.peek());
    Assertions.assertEquals(4, stack.size());
    stack.pop();
    stack.pop();
    stack.pop();
    stack.pop();
    Assertions.assertTrue(stack.isEmpty());
  }
}
```

:::

## ä¸¤ç§å®ç°å¯¹æ¯”

**æ”¯æŒæ“ä½œ**

ä¸¤ç§å®ç°éƒ½æ”¯æŒæ ˆå®šä¹‰ä¸­çš„å„é¡¹æ“ä½œã€‚æ•°ç»„å®ç°é¢å¤–æ”¯æŒéšæœºè®¿é—®ï¼Œä½†è¿™å·²è¶…å‡ºäº†æ ˆçš„å®šä¹‰èŒƒç•´ï¼Œå› æ­¤ä¸€èˆ¬ä¸ä¼šç”¨åˆ°ã€‚

**æ—¶é—´æ•ˆç‡**

åœ¨åŸºäºæ•°ç»„çš„å®ç°ä¸­ï¼Œå…¥æ ˆå’Œå‡ºæ ˆæ“ä½œéƒ½åœ¨é¢„å…ˆåˆ†é…å¥½çš„è¿ç»­å†…å­˜ä¸­è¿›è¡Œï¼Œå…·æœ‰å¾ˆå¥½çš„ç¼“å­˜æœ¬åœ°æ€§ï¼Œå› æ­¤æ•ˆç‡è¾ƒé«˜ã€‚ç„¶è€Œï¼Œå¦‚æœå…¥æ ˆæ—¶è¶…å‡ºæ•°ç»„å®¹é‡ï¼Œä¼šè§¦å‘æ‰©å®¹æœºåˆ¶ï¼Œå¯¼è‡´è¯¥æ¬¡å…¥æ ˆæ“ä½œçš„æ—¶é—´å¤æ‚åº¦å˜ä¸º ğ‘‚(ğ‘›) ã€‚

åœ¨åŸºäºé“¾è¡¨çš„å®ç°ä¸­ï¼Œé“¾è¡¨çš„æ‰©å®¹éå¸¸çµæ´»ï¼Œä¸å­˜åœ¨ä¸Šè¿°æ•°ç»„æ‰©å®¹æ—¶æ•ˆç‡é™ä½çš„é—®é¢˜ã€‚ä½†æ˜¯ï¼Œå…¥æ ˆæ“ä½œéœ€è¦åˆå§‹åŒ–èŠ‚ç‚¹å¯¹è±¡å¹¶ä¿®æ”¹æŒ‡é’ˆï¼Œå› æ­¤æ•ˆç‡ç›¸å¯¹è¾ƒä½ã€‚ä¸è¿‡ï¼Œå¦‚æœå…¥æ ˆå…ƒç´ æœ¬èº«å°±æ˜¯èŠ‚ç‚¹å¯¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥çœå»åˆå§‹åŒ–æ­¥éª¤ï¼Œä»è€Œæé«˜æ•ˆç‡ã€‚

ç»¼ä¸Šæ‰€è¿°ï¼Œå½“å…¥æ ˆä¸å‡ºæ ˆæ“ä½œçš„å…ƒç´ æ˜¯åŸºæœ¬æ•°æ®ç±»å‹æ—¶ï¼Œä¾‹å¦‚ `int` æˆ– `double` ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºã€‚

- åŸºäºæ•°ç»„å®ç°çš„æ ˆåœ¨è§¦å‘æ‰©å®¹æ—¶æ•ˆç‡ä¼šé™ä½ï¼Œä½†ç”±äºæ‰©å®¹æ˜¯ä½é¢‘æ“ä½œï¼Œå› æ­¤å¹³å‡æ•ˆç‡æ›´é«˜ã€‚
- åŸºäºé“¾è¡¨å®ç°çš„æ ˆå¯ä»¥æä¾›æ›´åŠ ç¨³å®šçš„æ•ˆç‡è¡¨ç°ã€‚

**ç©ºé—´æ•ˆç‡**

åœ¨åˆå§‹åŒ–åˆ—è¡¨æ—¶ï¼Œç³»ç»Ÿä¼šä¸ºåˆ—è¡¨åˆ†é…â€œåˆå§‹å®¹é‡â€ï¼Œè¯¥å®¹é‡å¯èƒ½è¶…å‡ºå®é™…éœ€æ±‚ï¼›å¹¶ä¸”ï¼Œæ‰©å®¹æœºåˆ¶é€šå¸¸æ˜¯æŒ‰ç…§ç‰¹å®šå€ç‡ï¼ˆä¾‹å¦‚ 2 å€ï¼‰è¿›è¡Œæ‰©å®¹çš„ï¼Œæ‰©å®¹åçš„å®¹é‡ä¹Ÿå¯èƒ½è¶…å‡ºå®é™…éœ€æ±‚ã€‚å› æ­¤ï¼Œ**åŸºäºæ•°ç»„å®ç°çš„æ ˆå¯èƒ½é€ æˆä¸€å®šçš„ç©ºé—´æµªè´¹**ã€‚

ç„¶è€Œï¼Œç”±äºé“¾è¡¨èŠ‚ç‚¹éœ€è¦é¢å¤–å­˜å‚¨æŒ‡é’ˆï¼Œ**å› æ­¤é“¾è¡¨èŠ‚ç‚¹å ç”¨çš„ç©ºé—´ç›¸å¯¹è¾ƒå¤§**ã€‚

ç»¼ä¸Šï¼Œæˆ‘ä»¬ä¸èƒ½ç®€å•åœ°ç¡®å®šå“ªç§å®ç°æ›´åŠ èŠ‚çœå†…å­˜ï¼Œéœ€è¦é’ˆå¯¹å…·ä½“æƒ…å†µè¿›è¡Œåˆ†æã€‚

## æ ˆçš„å…¸å‹åº”ç”¨

- **æµè§ˆå™¨ä¸­çš„åé€€ä¸å‰è¿›ã€è½¯ä»¶ä¸­çš„æ’¤é”€ä¸åæ’¤é”€**ã€‚æ¯å½“æˆ‘ä»¬æ‰“å¼€æ–°çš„ç½‘é¡µï¼Œæµè§ˆå™¨å°±ä¼šå¯¹ä¸Šä¸€ä¸ªç½‘é¡µæ‰§è¡Œå…¥æ ˆï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åé€€æ“ä½œå›åˆ°ä¸Šä¸€ä¸ªç½‘é¡µã€‚åé€€æ“ä½œå®é™…ä¸Šæ˜¯åœ¨æ‰§è¡Œå‡ºæ ˆã€‚å¦‚æœè¦åŒæ—¶æ”¯æŒåé€€å’Œå‰è¿›ï¼Œé‚£ä¹ˆéœ€è¦ä¸¤ä¸ªæ ˆæ¥é…åˆå®ç°ã€‚
- **ç¨‹åºå†…å­˜ç®¡ç†**ã€‚æ¯æ¬¡è°ƒç”¨å‡½æ•°æ—¶ï¼Œç³»ç»Ÿéƒ½ä¼šåœ¨æ ˆé¡¶æ·»åŠ ä¸€ä¸ªæ ˆå¸§ï¼Œç”¨äºè®°å½•å‡½æ•°çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚åœ¨é€’å½’å‡½æ•°ä¸­ï¼Œå‘ä¸‹é€’æ¨é˜¶æ®µä¼šä¸æ–­æ‰§è¡Œå…¥æ ˆæ“ä½œï¼Œè€Œå‘ä¸Šå›æº¯é˜¶æ®µåˆ™ä¼šä¸æ–­æ‰§è¡Œå‡ºæ ˆæ“ä½œã€‚
