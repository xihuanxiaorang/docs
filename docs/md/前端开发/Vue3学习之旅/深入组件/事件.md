# ç»„ä»¶äº‹ä»¶

## è§¦å‘ä¸ç›‘å¬äº‹ä»¶

**åœ¨ç»„ä»¶çš„æ¨¡æ¿è¡¨è¾¾å¼ä¸­**ï¼Œå¯ä»¥ç›´æ¥**ä½¿ç”¨ `$emit` æ–¹æ³•è§¦å‘è‡ªå®šä¹‰äº‹ä»¶** (ä¾‹å¦‚ï¼šåœ¨ `v-on` çš„å¤„ç†å‡½æ•°ä¸­)ï¼š

```html
<!-- MyComponent -->
<button @click="$emit('someEvent')">click me</button>
```

**çˆ¶ç»„ä»¶å¯ä»¥é€šè¿‡ `v-on` (ç¼©å†™ä¸º `@`) æ¥ç›‘å¬äº‹ä»¶**ï¼š

```html
<MyComponent @some-event="callback" />
```

åŒæ ·ï¼Œç»„ä»¶çš„äº‹ä»¶ç›‘å¬å™¨ä¹Ÿæ”¯æŒ `.once` ä¿®é¥°ç¬¦ï¼š

```html
<MyComponent @some-event.once="callback" />
```

åƒç»„ä»¶ä¸ prop ä¸€æ ·ï¼Œäº‹ä»¶çš„åå­—ä¹Ÿæä¾›äº†è‡ªåŠ¨çš„æ ¼å¼è½¬æ¢ã€‚æ³¨æ„è¿™é‡Œæˆ‘ä»¬è§¦å‘äº†ä¸€ä¸ª**ä»¥ camelCase å½¢å¼å‘½åçš„äº‹ä»¶ï¼Œä½†åœ¨çˆ¶ç»„ä»¶ä¸­å¯ä»¥ä½¿ç”¨ kebab-case å½¢å¼æ¥ç›‘å¬**ã€‚ä¸ [prop å¤§å°å†™æ ¼å¼](./Props.md#prop-name-casing)ä¸€æ ·ï¼Œåœ¨æ¨¡æ¿ä¸­æˆ‘ä»¬ä¹ŸğŸ‘**æ¨èä½¿ç”¨ kebab-case å½¢å¼æ¥ç¼–å†™ç›‘å¬å™¨**ã€‚

> [!tip]
>
> å’ŒåŸç”Ÿ DOM äº‹ä»¶ä¸ä¸€æ ·ï¼Œç»„ä»¶è§¦å‘çš„äº‹ä»¶**æ²¡æœ‰å†’æ³¡æœºåˆ¶**ã€‚ä½ **åªèƒ½ç›‘å¬<u>ç›´æ¥å­ç»„ä»¶</u>è§¦å‘çš„äº‹ä»¶**ã€‚å¹³çº§ç»„ä»¶æˆ–æ˜¯è·¨è¶Šå¤šå±‚åµŒå¥—çš„ç»„ä»¶é—´é€šä¿¡ï¼Œåº”ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„äº‹ä»¶æ€»çº¿ï¼Œæˆ–æ˜¯ä½¿ç”¨ä¸€ä¸ª[å…¨å±€çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ](https://cn.vuejs.org/guide/scaling-up/state-management.html)ã€‚

## äº‹ä»¶å‚æ•°

æœ‰æ—¶å€™æˆ‘ä»¬ä¼šéœ€è¦**åœ¨è§¦å‘äº‹ä»¶æ—¶é™„å¸¦ä¸€ä¸ªç‰¹å®šçš„å€¼**ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬æƒ³è¦ `<BlogPost>` ç»„ä»¶æ¥ç®¡ç†æ–‡æœ¬ä¼šç¼©æ”¾å¾—å¤šå¤§ã€‚åœ¨è¿™ä¸ªåœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥**ç»™ `$emit` æä¾›ä¸€ä¸ªé¢å¤–çš„å‚æ•°**ï¼š

```html
<button @click="$emit('increaseBy', 1)">
  Increase by 1
</button>
```

ç„¶åæˆ‘ä»¬**åœ¨çˆ¶ç»„ä»¶ä¸­ç›‘å¬äº‹ä»¶**ï¼Œæˆ‘ä»¬**å¯ä»¥å…ˆç®€å•å†™ä¸€ä¸ª<u>å†…è”çš„ç®­å¤´å‡½æ•°</u>ä½œä¸ºç›‘å¬å™¨ï¼Œæ­¤å‡½æ•°ä¼šæ¥æ”¶åˆ°äº‹ä»¶é™„å¸¦çš„å‚æ•°**ï¼š

```html
<MyButton @increase-by="(n) => count += n" />
```

æˆ–è€…ï¼Œä¹Ÿå¯ä»¥**ç”¨ä¸€ä¸ª<u>ç»„ä»¶æ–¹æ³•</u>æ¥ä½œä¸ºäº‹ä»¶å¤„ç†å‡½æ•°**ï¼š

```html
<MyButton @increase-by="increaseCount" />
```

è¯¥æ–¹æ³•ä¹Ÿä¼šæ¥æ”¶åˆ°äº‹ä»¶æ‰€ä¼ é€’çš„å‚æ•°ï¼š

```js
function increaseCount(n) {
  count.value += n
}
```

> [!tip]
>
> **æ‰€æœ‰ä¼ å…¥ `$emit()` çš„é¢å¤–å‚æ•°éƒ½ä¼šè¢«ç›´æ¥ä¼ å‘ç›‘å¬å™¨**ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œ`$emit('foo', 1, 2, 3)` è§¦å‘åï¼Œç›‘å¬å™¨å‡½æ•°å°†ä¼šæ”¶åˆ°è¿™ä¸‰ä¸ªå‚æ•°å€¼ã€‚

## å£°æ˜è§¦å‘çš„äº‹ä»¶

**ç»„ä»¶å¯ä»¥æ˜¾å¼åœ°é€šè¿‡ [`defineEmits()`](https://cn.vuejs.org/api/sfc-script-setup.html#defineprops-defineemits) å®æ¥å£°æ˜å®ƒè¦è§¦å‘çš„äº‹ä»¶**ï¼š

```vue
<script setup>
defineEmits(['inFocus', 'submit'])
</script>
```

æˆ‘ä»¬åœ¨ `<template>` ä¸­ä½¿ç”¨çš„ **`$emit` æ–¹æ³•*ä¸*èƒ½åœ¨ç»„ä»¶çš„ `<script setup>` éƒ¨åˆ†ä¸­ä½¿ç”¨**ï¼Œä½† **`defineEmits()` ä¼šè¿”å›ä¸€ä¸ªç›¸åŒä½œç”¨çš„å‡½æ•°ä¾›æˆ‘ä»¬ä½¿ç”¨**ï¼š

```vue
<script setup>
const emit = defineEmits(['inFocus', 'submit'])

function buttonClick() {
  emit('submit')
}
</script>
```

`defineEmits()` å®**ä¸èƒ½**åœ¨å­å‡½æ•°ä¸­ä½¿ç”¨ã€‚å¦‚ä¸Šæ‰€ç¤ºï¼Œ**å®ƒå¿…é¡»ç›´æ¥æ”¾ç½®åœ¨ `<script setup>` çš„é¡¶çº§ä½œç”¨åŸŸä¸‹**ã€‚

å¦‚æœä½ **æ˜¾å¼åœ°ä½¿ç”¨äº† `setup` å‡½æ•°**è€Œä¸æ˜¯ `<script setup>`ï¼Œ**åˆ™äº‹ä»¶éœ€è¦é€šè¿‡ [`emits`](https://cn.vuejs.org/api/options-state.html#emits) é€‰é¡¹æ¥å®šä¹‰**ï¼Œ**`emit` å‡½æ•°ä¹Ÿè¢«æš´éœ²åœ¨ `setup()` çš„ä¸Šä¸‹æ–‡å¯¹è±¡ä¸Š**ï¼š

```js
export default {
  emits: ['inFocus', 'submit'],
  setup(props, ctx) {
    ctx.emit('submit')
  }
}
```

ä¸ `setup()` ä¸Šä¸‹æ–‡å¯¹è±¡ä¸­çš„å…¶ä»–å±æ€§ä¸€æ ·ï¼Œ**`emit` å¯ä»¥å®‰å…¨åœ°è¢«è§£æ„**ï¼š

```js
export default {
  emits: ['inFocus', 'submit'],
  setup(props, { emit }) {
    emit('submit')
  }
}
```

è¿™ä¸ª **`emits` é€‰é¡¹å’Œ `defineEmits()` å®è¿˜æ”¯æŒ<u>å¯¹è±¡</u>è¯­æ³•**ã€‚é€šè¿‡ TypeScript ä¸ºå‚æ•°æŒ‡å®šç±»å‹ï¼Œå®ƒ**å…è®¸æˆ‘ä»¬å¯¹è§¦å‘äº‹ä»¶çš„å‚æ•°è¿›è¡ŒéªŒè¯**ï¼š

```vue
<script setup lang="ts">
const emit = defineEmits({
  submit(payload: { email: string, password: string }) {
    // é€šè¿‡è¿”å›å€¼ä¸º `true` è¿˜æ˜¯ä¸º `false` æ¥åˆ¤æ–­
    // éªŒè¯æ˜¯å¦é€šè¿‡
  }
})
</script>
```

å¦‚æœä½ æ­£åœ¨æ­é… TypeScript ä½¿ç”¨ `<script setup>`ï¼Œä¹Ÿ**å¯ä»¥ä½¿ç”¨<u>çº¯ç±»å‹æ ‡æ³¨</u>æ¥å£°æ˜è§¦å‘çš„äº‹ä»¶**ï¼š

```vue
<script setup lang="ts">
const emit = defineEmits<{
  (e: 'change', id: number): void
  (e: 'update', value: string): void
}>()
</script>
```

TypeScript ç”¨æˆ·è¯·å‚è€ƒï¼š[å¦‚ä½•ä¸ºç»„ä»¶æ‰€æŠ›å‡ºäº‹ä»¶æ ‡æ³¨ç±»å‹](https://cn.vuejs.org/guide/typescript/composition-api.html#typing-component-emits) <Badge type="tip" text="TS" />

å°½ç®¡**äº‹ä»¶å£°æ˜æ˜¯å¯é€‰çš„**ï¼Œæˆ‘ä»¬è¿˜æ˜¯ğŸ‘**æ¨èä½ å®Œæ•´åœ°å£°æ˜æ‰€æœ‰è¦è§¦å‘çš„äº‹ä»¶**ï¼Œ**ä»¥æ­¤åœ¨ä»£ç ä¸­ä½œä¸ºæ–‡æ¡£è®°å½•ç»„ä»¶çš„ç”¨æ³•**ã€‚åŒæ—¶ï¼Œ**äº‹ä»¶å£°æ˜èƒ½è®© Vue æ›´å¥½åœ°å°†äº‹ä»¶å’Œ[é€ä¼  attribute](https://cn.vuejs.org/guide/components/attrs.html#v-on-listener-inheritance) ä½œå‡ºåŒºåˆ†**ï¼Œä»è€Œé¿å…ä¸€äº›ç”±ç¬¬ä¸‰æ–¹ä»£ç è§¦å‘çš„è‡ªå®šä¹‰ DOM äº‹ä»¶æ‰€å¯¼è‡´çš„è¾¹ç•Œæƒ…å†µã€‚

> [!tip]
>
> å¦‚æœä¸€ä¸ªåŸç”Ÿäº‹ä»¶çš„åå­— (ä¾‹å¦‚ `click`) è¢«å®šä¹‰åœ¨ `emits` é€‰é¡¹ä¸­ï¼Œåˆ™ç›‘å¬å™¨åªä¼šç›‘å¬ç»„ä»¶è§¦å‘çš„ `click` äº‹ä»¶è€Œä¸ä¼šå†å“åº”åŸç”Ÿçš„ `click` äº‹ä»¶ã€‚

## äº‹ä»¶æ ¡éªŒ {#validate-emitted-events}

å’Œå¯¹ props æ·»åŠ ç±»å‹æ ¡éªŒçš„æ–¹å¼ç±»ä¼¼ï¼Œ**æ‰€æœ‰è§¦å‘çš„äº‹ä»¶ä¹Ÿå¯ä»¥ä½¿ç”¨å¯¹è±¡å½¢å¼æ¥æè¿°**ã€‚

è¦**ä¸ºäº‹ä»¶æ·»åŠ æ ¡éªŒ**ï¼Œé‚£ä¹ˆ**äº‹ä»¶å¯ä»¥è¢«èµ‹å€¼ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—çš„å‚æ•°å°±æ˜¯æŠ›å‡ºäº‹ä»¶æ—¶ä¼ å…¥ `emit` çš„å†…å®¹ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼æ¥è¡¨æ˜äº‹ä»¶æ˜¯å¦åˆæ³•**ã€‚

```vue
<script setup>
const emit = defineEmits({
  // æ²¡æœ‰æ ¡éªŒ
  click: null,

  // æ ¡éªŒ submit äº‹ä»¶
  submit: ({ email, password }) => {
    if (email && password) {
      return true
    } else {
      console.warn('Invalid submit event payload!')
      return false
    }
  }
})

function submitForm(email, password) {
  emit('submit', { email, password })
}
</script>
```

