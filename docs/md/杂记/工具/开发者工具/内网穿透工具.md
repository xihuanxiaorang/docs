# å†…ç½‘ç©¿é€å·¥å…·

## é’‰é’‰

> [å†…ç½‘ç©¿é€ï¼ˆæµ‹è¯•ç‰ˆï¼‰--å·²åºŸå¼ƒ - å¼€æ”¾å¹³å°](https://open.dingtalk.com/document/resourcedownload/http-intranet-penetration)

1. ä¸‹è½½å®¢æˆ·ç«¯ `git clone https://github.com/open-dingtalk/dingtalk-pierced-client.git `
2. å¯åŠ¨å®¢æˆ·ç«¯ `ding.exe -config=ding.cfg -subdomain=abcde 8080`
   1. -subdomainï¼šä½ éœ€è¦ä½¿ç”¨çš„åŸŸåå‰ç¼€ï¼Œè¯¥å‰ç¼€å°†ä¼šåŒ¹é…åˆ°â€œvaiwan.comâ€å‰é¢ï¼Œä¾‹å¦‚ä½ çš„subdomainæ˜¯abcdeï¼Œå¯åŠ¨å·¥å…·åä¼šå°†abcde.vaiwan.comæ˜ å°„åˆ°æœ¬åœ°
   2. portï¼šä½ éœ€è¦ä»£ç†çš„æœ¬åœ°æœåŠ¡http-serverç«¯å£ï¼Œä¾‹å¦‚ä½ æœ¬åœ°ç«¯å£ä¸º8080ç­‰
3. æ³¨æ„äº‹é¡¹ï¼š
   1. éœ€è¦è®¿é—®çš„åŸŸåæ˜¯http://abcde.vaiwan.com/xxxxx è€Œä¸æ˜¯http://abcde.vaiwan.com:8080/xxxxx
   2. å¯åŠ¨å‘½ä»¤çš„subdomainå‚æ•°æœ‰å¯èƒ½è¢«åˆ«äººå ç”¨ï¼Œå°½é‡ä¸è¦ç”¨å¸¸ç”¨å­—ç¬¦ï¼Œå¯ä»¥ç”¨è‡ªå·±å…¬å¸åçš„æ‹¼éŸ³ï¼Œä¾‹å¦‚ï¼šalibabaã€dingdingç­‰
   3. å¯ä»¥åœ¨æœ¬åœ°èµ·ä¸ªhttp-serveræœåŠ¡ï¼Œæ”¾ç½®ä¸€ä¸ªindex.htmlæ–‡ä»¶ï¼Œç„¶åè®¿é—®http://abcde.vaiwan.com/index.htmlæµ‹è¯•ä¸€ä¸‹

## NATAPP

> [NATAPP-å†…ç½‘ç©¿é€ åŸºäºngrokçš„å›½å†…é«˜é€Ÿå†…ç½‘æ˜ å°„å·¥å…·](https://natapp.cn/)

1. æ³¨å†Œå¹¶ç™»é™†è´¦å·ï¼Œå¼€é€šä¸€ä¸ªå…è´¹éš§é“ï¼ˆæ¯æ¬¡å¯åŠ¨åŸŸåä¼šå‘ç”Ÿå˜åŒ–ï¼‰
2. å¡«å†™é…ç½®ä¿¡æ¯ï¼Œä¿®æ”¹ä½ éœ€è¦æ˜ å°„åˆ°æœ¬åœ°çš„å“ªä¸ªç«¯å£
3. åœ¨æˆ‘çš„éš§é“åˆ—è¡¨ä¸­å¯ä»¥æŸ¥çœ‹åˆšæ‰å¼€é€šçš„éš§é“
4. ä¸‹è½½[å®¢æˆ·ç«¯](https://cdn.natapp.cn/assets/downloads/clients/2_3_9/natapp_windows_amd64_2_3_9.zip?version=20230407)ï¼Œè§£å‹
5. å¯åŠ¨å®¢æˆ·ç«¯ï¼Œéœ€è¦å…ˆä¸‹è½½ä¸€ä»½é…ç½®æ–‡ä»¶ [ä½¿ç”¨æœ¬åœ°é…ç½®æ–‡ä»¶config.ini](https://natapp.cn/article/config_ini)ï¼Œå°†è¯¥æ–‡ä»¶æ”¾ç½®äº natapp åŒçº§ç›®å½•ï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ authtoken ä¸ºåˆšæ‰å¼€é€šéš§é“ä¸­çš„ authtoken

## nps

### ä»‹ç»

> Github ä»“åº“åœ°å€ï¼š[ä¸€æ¬¾è½»é‡çº§ã€é«˜æ€§èƒ½ã€åŠŸèƒ½å¼ºå¤§çš„å†…ç½‘ç©¿é€ä»£ç†æœåŠ¡å™¨](https://github.com/ehang-io/nps) ğŸš€
>
> é¡¹ç›®æ–‡æ¡£åœ°å€ï¼šhttps://ehang-io.github.io/nps/#/

nps æ˜¯ä¸€æ¬¾è½»é‡çº§ã€é«˜æ€§èƒ½ã€åŠŸèƒ½å¼ºå¤§çš„å†…ç½‘ç©¿é€ä»£ç†æœåŠ¡å™¨ã€‚ç›®å‰æ”¯æŒ tcpã€udp æµé‡è½¬å‘ï¼Œå¯æ”¯æŒä»»ä½• tcpã€udp ä¸Šå±‚åè®®ï¼ˆè®¿é—®å†…ç½‘ç½‘ç«™ã€æœ¬åœ°æ”¯ä»˜æ¥å£è°ƒè¯•ã€ssh è®¿é—®ã€è¿œç¨‹æ¡Œé¢ï¼Œå†…ç½‘ dns è§£æç­‰ç­‰â€¦â€¦ï¼‰ï¼Œæ­¤å¤–è¿˜æ”¯æŒå†…ç½‘httpä»£ç†ã€å†…ç½‘ socks5 ä»£ç†ã€p2p ç­‰ï¼Œå¹¶å¸¦æœ‰åŠŸèƒ½å¼ºå¤§çš„ web ç®¡ç†ç«¯ã€‚

### å…¥é—¨

#### Linux æœåŠ¡ç«¯

- å®‰è£…

  - ä¸‹è½½[å®‰è£…åŒ…](https://github.com/ehang-io/nps/releases/download/v0.26.10/linux_amd64_server.tar.gz)
  - ä¸Šä¼ è‡³ /opt ç›®å½•
  - è§£å‹ï¼šmkdir nps-server & tar -zxvf linux_amd64_server.tar.gz -C ./nps-server

- å¯åŠ¨

  - å¯åŠ¨ï¼šsudo nps start

    - é…ç½®æ–‡ä»¶æ‰€åœ¨è·¯å¾„ï¼š/etc/nps/conf/nps.conf

    - è®¿é—®æœåŠ¡ç«¯ ip:portï¼Œé»˜è®¤ä¸º 8080 ç«¯å£

      > [!note]
      >
      > å¦‚æœé¡µé¢æ— æ³•è®¿é—®çš„è¯ï¼Œè¯·æŸ¥çœ‹ç«¯å£æ˜¯å¦å¼€æ”¾ï¼Œå¦‚æœæ²¡æœ‰å¼€æ”¾çš„è¯ï¼Œåˆ™è¿›å…¥äº‘å‚å•†æ§åˆ¶å°->é˜²ç«å¢™->å¼€æ”¾æŒ‡å®šç«¯å£ã€‚

    - ç”¨æˆ·å/å¯†ç ï¼šadmin/123ï¼Œæ­£å¼ä½¿ç”¨æ—¶ä¸€å®šè¦ä¿®æ”¹ï¼<br />![imported_253168b01994ba367165078ec838c67e417d2eef164de2423175875fae0444ce](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img2/202411171059792.png)

  - åœæ­¢ï¼šsudo nps stop

  - é‡å¯ï¼šsudo nps restart

- åˆ›å»ºå®¢æˆ·ç«¯ <br />![imported_2124356c3d08558d587e5a5e2f3d0038e6f33d3058989d48ca5c382aafad08a5](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img2/202411171102704.png)

  å¯ä»¥çœ‹åˆ°ï¼Œç›®å‰å®¢æˆ·ç«¯è¿æ¥çŠ¶æ€å¤„äºç¦»çº¿ä¸­ï¼Œåœ¨å®¢æˆ·ç«¯ä¸€ä¾§éœ€è¦é€šè¿‡ä¸Šå›¾æ¡†é€‰å‡ºæ¥çš„å®¢æˆ·ç«¯å‘½ä»¤è¿›è¡Œè¿æ¥ã€‚

#### Windows å®¢æˆ·ç«¯

- å®‰è£…

  - ä¸‹è½½[å®‰è£…åŒ…](https://github.com/ehang-io/nps/releases/download/v0.26.10/windows_amd64_client.tar.gz)
  - è§£å‹å¹¶è¿›å…¥è§£å‹ç›®å½•ä¸­

- å¯åŠ¨

  - ç‚¹å‡»webç®¡ç†ä¸­å®¢æˆ·ç«¯å‰çš„+å·ï¼Œå¤åˆ¶å¯åŠ¨å‘½ä»¤

  - ä»¥ç®¡ç†å‘˜èº«ä»½åœ¨ cmd æˆ–è€… git bash ç»ˆç«¯ä¸­æ‰§è¡Œå¯åŠ¨å‘½ä»¤ï¼Œå¦‚æœä½¿ç”¨ powershell è¿è¡Œï¼Œè¯·å°† ip æ‹¬èµ·æ¥ï¼<br />![imported_628e37de537579bd3ef1776384705a630cda5caff513540dbadc39783b7a61cd](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img2/202411171105228.png)

    > [!note]
    >
    > å¦‚æœè¿æ¥ä¸æˆåŠŸçš„è¯ï¼Œè¯·æŸ¥çœ‹ç«¯å£æ˜¯å¦å¼€æ”¾ï¼Œå¦‚æœæ²¡æœ‰å¼€æ”¾çš„è¯ï¼Œåˆ™è¿›å…¥äº‘å‚å•†æ§åˆ¶å°->é˜²ç«å¢™->å¼€æ”¾æŒ‡å®šç«¯å£ã€‚

- æ³¨å†Œåˆ°ç³»ç»ŸæœåŠ¡

  - æ³¨å†Œï¼šä»¥ç®¡ç†å‘˜èº«ä»½åœ¨ cmd æˆ–è€… git bash ç»ˆç«¯ä¸­æ‰§è¡Œå‘½ä»¤ï¼š ./npc install -server=117.72.106.71:8024 -vkey=a5kqua6h987gne29 -type=tcp

    > [!note]
    >
    > å¦‚æœéœ€è¦æ›´æ¢å‘½ä»¤å†…å®¹éœ€è¦å…ˆå¸è½½ npc.exe uninstallï¼Œå†é‡æ–°æ³¨å†Œï¼

  - å¯åŠ¨ï¼š./npc start

  - åœæ­¢ï¼š./npc stop


### ä½¿ç”¨

#### [åŸŸåè§£æ](https://ehang-io.github.io/nps/#/example?id=åŸŸåè§£æ)

**é€‚ç”¨èŒƒå›´ï¼š** <u>å°ç¨‹åºå¼€å‘</u>ã€<u>å¾®ä¿¡å…¬ä¼—å·å¼€å‘</u>ã€äº§å“æ¼”ç¤º

> [!note]
>
> åŸŸåè§£ææ¨¡å¼ä¸º http åå‘ä»£ç†ï¼Œä¸æ˜¯ dns æœåŠ¡å™¨ï¼Œåœ¨ web ä¸Šèƒ½å¤Ÿè½»æ¾çµæ´»é…ç½®ã€‚

**å‡è®¾åœºæ™¯ï¼š**

- ä¸€ä¸ªåŸŸå fun.xiaorang
- ä¸€å°å…¬ç½‘æœºå™¨ ip ä¸º 117.72.106.71
- ä¸€ä¸ªå†…ç½‘å¼€å‘ç«™ç‚¹ 127.0.0.1:8888
- æƒ³é€šè¿‡ mp.fun.xiaorang è®¿é—® 127.0.0.1:8888

**ä½¿ç”¨æ­¥éª¤**

- å°† *.fun.xiaorang è§£æåˆ°å…¬ç½‘æœåŠ¡å™¨ 117.72.106.71ã€‚<br />![image-20241119114310334](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img2/202411191143635.png)
- ç‚¹å‡»åˆšæ‰åˆ›å»ºçš„å®¢æˆ·ç«¯çš„åŸŸåç®¡ç†ï¼Œæ·»åŠ è§„åˆ™ï¼šåŸŸåï¼š`mp.fun.xiaorang`ï¼Œå†…ç½‘ç›®æ ‡ï¼š`127.0.0.1:8888`ã€‚<br />![image-20241119114604495](https://cdn.jsdelivr.net/gh/xihuanxiaorang/img2/202411191146588.png)

ç°åœ¨è®¿é—® `mp.fun.xiaorang` å³å¯æˆåŠŸï¼

### ğŸ“ºèµ„æ–™

- [è¶…è½»é‡çº§NPSå†…ç½‘ç©¿é€è‡ªå¸¦åå°è®¾ç½®ç•Œé¢ï¼Œè¶…å¥½ç”¨FRPå¯ä»¥ä¸‹å°äº†](https://www.bilibili.com/video/BV11t411K7Cg?vd_source=84272a2d7f72158b38778819be5bc6ad)
- [ä¸€é”®å®ç°å†…ç½‘ç©¿é€ï¼šNPSå†…ç½‘ç©¿é€å·¥å…·çš„å®Œæ•´ä½¿ç”¨æŒ‡å—](https://www.bilibili.com/video/BV1Ed4y1f7jZ?vd_source=84272a2d7f72158b38778819be5bc6ad)
